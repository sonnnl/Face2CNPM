{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useDispatch}from\"react-redux\";import{useNavigate,useLocation}from\"react-router-dom\";import{useSnackbar}from\"notistack\";import axios from\"../utils/axios\";import{Container,Box,Typography,Button,Paper,Radio,RadioGroup,FormControlLabel,FormControl,FormLabel,CircularProgress,Avatar}from\"@mui/material\";import{setCredentials}from\"../redux/slices/authSlice\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://localhost:5000/api\";const RoleSelectionPage=()=>{const dispatch=useDispatch();const navigate=useNavigate();const location=useLocation();const{enqueueSnackbar}=useSnackbar();const[isLoading,setIsLoading]=useState(false);const[selectedRole,setSelectedRole]=useState(\"student\");// Lấy thông tin từ URL params\nconst queryParams=new URLSearchParams(location.search);const email=queryParams.get(\"email\");const googleId=queryParams.get(\"googleId\");const name=queryParams.get(\"name\");const avatar=queryParams.get(\"avatar\");useEffect(()=>{// Kiểm tra xem có đủ thông tin không\nif(!email||!googleId){enqueueSnackbar(\"Thiếu thông tin cần thiết để hoàn tất đăng ký\",{variant:\"error\"});navigate(\"/login\");}},[email,googleId,navigate,enqueueSnackbar]);const handleRoleChange=event=>{setSelectedRole(event.target.value);};const handleSubmit=async()=>{setIsLoading(true);try{const response=await axios.post(`${API_URL}/auth/google-complete`,{email,googleId,fullName:name,avatarUrl:avatar,role:selectedRole});if(response.data.success){// Lưu token và thông tin user\ndispatch(setCredentials({token:response.data.token,user:response.data.user}));enqueueSnackbar(\"Đăng ký thành công!\",{variant:\"success\"});navigate(\"/dashboard\");}}catch(error){var _error$response,_error$response$data;const errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||\"Đăng ký thất bại\";enqueueSnackbar(errorMessage,{variant:\"error\"});}finally{setIsLoading(false);}};return/*#__PURE__*/_jsx(Container,{component:\"main\",maxWidth:\"sm\",children:/*#__PURE__*/_jsx(Box,{sx:{marginTop:8,display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},children:/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{padding:4,width:\"100%\",borderRadius:3,display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h4\",gutterBottom:true,children:\"Ho\\xE0n t\\u1EA5t \\u0111\\u0103ng k\\xFD\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",mb:3,children:\"Ch\\xE0o m\\u1EEBng! Vui l\\xF2ng ch\\u1ECDn vai tr\\xF2 c\\u1EE7a b\\u1EA1n \\u0111\\u1EC3 ti\\u1EBFp t\\u1EE5c.\"}),avatar&&/*#__PURE__*/_jsx(Avatar,{src:avatar,alt:name||email,sx:{width:80,height:80,mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:name||email}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",mb:4,children:email}),/*#__PURE__*/_jsxs(FormControl,{component:\"fieldset\",sx:{mb:4,width:\"100%\"},children:[/*#__PURE__*/_jsx(FormLabel,{component:\"legend\",children:\"Ch\\u1ECDn vai tr\\xF2 c\\u1EE7a b\\u1EA1n\"}),/*#__PURE__*/_jsxs(RadioGroup,{\"aria-label\":\"role\",name:\"role\",value:selectedRole,onChange:handleRoleChange,children:[/*#__PURE__*/_jsx(FormControlLabel,{value:\"student\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Sinh vi\\xEAn\"}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"teacher\",control:/*#__PURE__*/_jsx(Radio,{}),label:\"Gi\\u1EA3ng vi\\xEAn\"})]})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",fullWidth:true,onClick:handleSubmit,disabled:isLoading,sx:{py:1.5},children:isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:24,color:\"inherit\"}):\"Hoàn tất đăng ký\"})]})})});};export default RoleSelectionPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}