{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kasiz\\\\Documents\\\\Studying\\\\FaceReg\\\\frontend\\\\src\\\\components\\\\FaceRegistrationComponent.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, lazy, Suspense } from \"react\";\nimport { useSnackbar } from \"notistack\";\nimport { Box, Typography, Button, CircularProgress, Alert, Stack, Avatar, Paper } from \"@mui/material\";\nimport { CameraAlt, CheckCircleOutline, ErrorOutline, Person, Replay } from \"@mui/icons-material\";\nimport { loadModels, detectFace } from \"../utils/faceUtils\";\n// import * as faceapi from \"face-api.js\"; // Removed real-time landmark logic\n\n// Lazy load Webcam\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Webcam = /*#__PURE__*/lazy(_c = () => import(\"react-webcam\"));\n\n// Consistent video constraints\n_c2 = Webcam;\nconst videoConstraints = {\n  width: {\n    ideal: 480\n  },\n  // Slightly larger for better capture\n  height: {\n    ideal: 360\n  },\n  facingMode: \"user\"\n};\nconst FaceRegistrationComponent = ({\n  onFaceDataCapture,\n  requiredImages = 3\n}) => {\n  _s();\n  // Refs\n  const webcamRef = useRef(null);\n\n  // State\n  const [modelsLoaded, setModelsLoaded] = useState(false);\n  const [modelLoadingError, setModelLoadingError] = useState(null);\n  const [cameraReady, setCameraReady] = useState(false);\n  const [cameraError, setCameraError] = useState(null);\n  const [capturedImages, setCapturedImages] = useState([]); // Array of { img: base64, descriptor: Float32Array }\n  const [isProcessing, setIsProcessing] = useState(false); // For capture operation only\n  const [captureError, setCaptureError] = useState(\"\");\n  const {\n    enqueueSnackbar\n  } = useSnackbar();\n\n  // 1. Load face recognition models on mount\n  useEffect(() => {\n    const initModels = async () => {\n      setModelLoadingError(null); // Reset error\n      try {\n        console.log(\"[FaceComponent] Loading models...\");\n        await loadModels();\n        setModelsLoaded(true);\n        console.log(\"[FaceComponent] Models loaded successfully.\");\n        // enqueueSnackbar(\"Đã tải mô hình nhận diện\", { variant: \"success\", autoHideDuration: 1500 });\n      } catch (err) {\n        console.error(\"[FaceComponent] Error loading models:\", err);\n        setModelLoadingError(\"Không thể tải mô hình nhận diện. Vui lòng thử tải lại trang.\");\n        enqueueSnackbar(\"Lỗi tải mô hình nhận diện\", {\n          variant: \"error\"\n        });\n      }\n    };\n    initModels();\n  }, [enqueueSnackbar]); // Run only once on mount\n\n  // 2. Handle camera state changes\n  const handleUserMedia = () => {\n    console.log(\"[FaceComponent] Camera is ready.\");\n    setCameraReady(true);\n    setCameraError(null); // Clear previous camera error\n  };\n  const handleUserMediaError = error => {\n    console.error(\"[FaceComponent] Camera error:\", error);\n    setCameraReady(false);\n    const errorMsg = \"Không thể truy cập camera. Vui lòng cấp quyền và thử lại.\";\n    setCameraError(errorMsg);\n    enqueueSnackbar(errorMsg, {\n      variant: \"error\"\n    });\n  };\n\n  // 3. Capture and detect face\n  const captureImage = async () => {\n    // Basic checks\n    if (!webcamRef.current || !cameraReady || isProcessing || !modelsLoaded) {\n      let reason = \"Chưa sẵn sàng\";\n      if (!cameraReady) reason = \"Camera chưa sẵn sàng\";else if (isProcessing) reason = \"Đang xử lý\";else if (!modelsLoaded) reason = \"Mô hình chưa tải xong\";\n      enqueueSnackbar(`Không thể chụp ảnh: ${reason}`, {\n        variant: \"warning\"\n      });\n      return;\n    }\n    if (capturedImages.length >= requiredImages) {\n      enqueueSnackbar(`Đã chụp đủ ${requiredImages} ảnh.`, {\n        variant: \"info\"\n      });\n      return;\n    }\n    setIsProcessing(true);\n    setCaptureError(\"\"); // Clear previous capture error\n\n    try {\n      const imageSrc = webcamRef.current.getScreenshot({\n        width: videoConstraints.width.ideal,\n        height: videoConstraints.height.ideal\n      });\n      if (!imageSrc) {\n        throw new Error(\"Không thể chụp ảnh từ webcam.\");\n      }\n\n      // Perform face detection\n      console.log(\"[FaceComponent] Detecting face in captured image...\");\n      const detections = await detectFace(imageSrc);\n      if (!detections || !detections.descriptor) {\n        console.warn(\"[FaceComponent] Face detection failed or no descriptor found.\");\n        enqueueSnackbar(\"Không phát hiện được khuôn mặt rõ ràng. Hãy thử lại.\", {\n          variant: \"warning\"\n        });\n        setIsProcessing(false); // Allow retry\n        return;\n      }\n      console.log(\"[FaceComponent] Face detected successfully.\");\n\n      // Store image and descriptor\n      const newImageData = {\n        img: imageSrc,\n        descriptor: Array.from(detections.descriptor) // Ensure serializable\n      };\n      const updatedImages = [...capturedImages, newImageData];\n      setCapturedImages(updatedImages);\n      enqueueSnackbar(`Đã chụp ảnh ${updatedImages.length}/${requiredImages}`, {\n        variant: \"success\",\n        autoHideDuration: 1500\n      });\n\n      // If enough images captured, notify parent immediately\n      if (updatedImages.length >= requiredImages) {\n        console.log(`[FaceComponent] Captured ${requiredImages} images. Calling onFaceDataCapture.`);\n        onFaceDataCapture(updatedImages); // Pass all captured data\n        enqueueSnackbar(`Đã chụp đủ ${requiredImages} ảnh!`, {\n          variant: \"info\"\n        });\n      }\n    } catch (err) {\n      console.error(\"[FaceComponent] Error capturing image:\", err);\n      const errorMsg = \"Lỗi khi chụp ảnh. Vui lòng thử lại.\";\n      setCaptureError(errorMsg);\n      enqueueSnackbar(errorMsg, {\n        variant: \"error\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // 4. Reset capture\n  const resetCapture = () => {\n    console.log(\"[FaceComponent] Resetting capture.\");\n    setCapturedImages([]);\n    setCaptureError(\"\");\n    // Notify parent that data is cleared (optional, depends on parent needs)\n    // onFaceDataCapture(null); or onFaceDataCapture([]);\n    enqueueSnackbar(\"Đã xóa ảnh đã chụp, bạn có thể chụp lại.\", {\n      variant: \"info\"\n    });\n  };\n\n  // --- Render Logic ---\n\n  const renderCameraView = () => /*#__PURE__*/_jsxDEV(Paper, {\n    elevation: 2,\n    sx: {\n      position: \"relative\",\n      width: \"100%\",\n      maxWidth: `${videoConstraints.width.ideal}px`,\n      aspectRatio: `${videoConstraints.width.ideal} / ${videoConstraints.height.ideal}`,\n      margin: \"16px auto\",\n      overflow: \"hidden\",\n      bgcolor: \"grey.200\",\n      border: cameraError ? \"2px solid red\" : \"1px solid\",\n      borderColor: \"divider\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Suspense, {\n      fallback: /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          position: \"absolute\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%, -50%)\"\n        },\n        children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 11\n      }, this),\n      children: /*#__PURE__*/_jsxDEV(Webcam, {\n        audio: false,\n        ref: webcamRef,\n        screenshotFormat: \"image/jpeg\",\n        videoConstraints: videoConstraints,\n        onUserMedia: handleUserMedia,\n        onUserMediaError: handleUserMediaError,\n        style: {\n          display: \"block\",\n          width: \"100%\",\n          height: \"100%\",\n          objectFit: \"cover\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this), (!modelsLoaded || !cameraReady || cameraError || modelLoadingError) && /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        color: \"white\",\n        textAlign: \"center\",\n        p: 2\n      },\n      children: [/*#__PURE__*/_jsxDEV(CircularProgress, {\n        color: \"inherit\",\n        sx: {\n          mb: 2\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 11\n      }, this), modelLoadingError && /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        color: \"error\",\n        children: modelLoadingError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 13\n      }, this), cameraError && /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        color: \"error\",\n        children: cameraError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 13\n      }, this), !modelLoadingError && !cameraError && !modelsLoaded && /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"\\u0110ang t\\u1EA3i m\\xF4 h\\xECnh...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 13\n      }, this), !modelLoadingError && !cameraError && modelsLoaded && !cameraReady && /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"\\u0110ang kh\\u1EDFi \\u0111\\u1ED9ng camera...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 180,\n    columnNumber: 5\n  }, this);\n  const renderCaptureControls = () => /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      textAlign: \"center\",\n      mt: 2\n    },\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      startIcon: /*#__PURE__*/_jsxDEV(CameraAlt, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 20\n      }, this),\n      onClick: captureImage,\n      disabled: !cameraReady || !modelsLoaded || isProcessing || capturedImages.length >= requiredImages || !!cameraError || !!modelLoadingError,\n      sx: {\n        mb: 1,\n        mr: 1\n      },\n      children: isProcessing ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n        size: 24,\n        color: \"inherit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 11\n      }, this) : `Chụp ảnh (${capturedImages.length}/${requiredImages})`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"outlined\",\n      color: \"warning\",\n      startIcon: /*#__PURE__*/_jsxDEV(Replay, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 20\n      }, this),\n      onClick: resetCapture,\n      disabled: capturedImages.length === 0 || isProcessing,\n      sx: {\n        mb: 1\n      },\n      children: \"Ch\\u1EE5p l\\u1EA1i\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 7\n    }, this), captureError && /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"error\",\n      sx: {\n        mt: 2,\n        textAlign: \"left\"\n      },\n      children: captureError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 267,\n    columnNumber: 5\n  }, this);\n  const renderImagePreviews = () => capturedImages.length > 0 && /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      mt: 2,\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"caption\",\n      display: \"block\",\n      gutterBottom: true,\n      children: \"\\u1EA2nh \\u0111\\xE3 ch\\u1EE5p:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n      direction: \"row\",\n      spacing: 1,\n      justifyContent: \"center\",\n      flexWrap: \"wrap\",\n      children: [capturedImages.map((imgData, index) => /*#__PURE__*/_jsxDEV(Avatar, {\n        src: imgData.img,\n        sx: {\n          width: 56,\n          height: 56\n        }\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 13\n      }, this)), [...Array(Math.max(0, requiredImages - capturedImages.length))].map((_, i) => /*#__PURE__*/_jsxDEV(Avatar, {\n        sx: {\n          width: 56,\n          height: 56,\n          bgcolor: \"grey.300\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Person, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 17\n        }, this)\n      }, `placeholder-${i}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 15\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 309,\n    columnNumber: 7\n  }, this);\n\n  // --- Main Component Render ---\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: [!modelsLoaded && !modelLoadingError && /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        p: 2\n      },\n      children: [/*#__PURE__*/_jsxDEV(CircularProgress, {\n        size: 20,\n        sx: {\n          mr: 1\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"\\u0110ang t\\u1EA3i m\\xF4 h\\xECnh nh\\u1EADn di\\u1EC7n...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 9\n    }, this), modelLoadingError && /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"error\",\n      sx: {\n        mb: 2\n      },\n      children: modelLoadingError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 9\n    }, this), modelsLoaded && !modelLoadingError && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [renderCameraView(), renderCaptureControls(), renderImagePreviews()]\n    }, void 0, true), capturedImages.length >= requiredImages && /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"success\",\n      icon: /*#__PURE__*/_jsxDEV(CheckCircleOutline, {\n        fontSize: \"inherit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 17\n      }, this),\n      sx: {\n        mt: 2\n      },\n      children: [\"\\u0110\\xE3 ch\\u1EE5p \\u0111\\u1EE7 \", requiredImages, \" \\u1EA3nh. B\\u1EA1n c\\xF3 th\\u1EC3 ti\\u1EBFp t\\u1EE5c.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 343,\n    columnNumber: 5\n  }, this);\n};\n_s(FaceRegistrationComponent, \"kLQyZIIiV2T3kuL1145uTUsCljo=\", false, function () {\n  return [useSnackbar];\n});\n_c3 = FaceRegistrationComponent;\nexport default FaceRegistrationComponent;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"Webcam$lazy\");\n$RefreshReg$(_c2, \"Webcam\");\n$RefreshReg$(_c3, \"FaceRegistrationComponent\");","map":{"version":3,"names":["React","useState","useEffect","useRef","lazy","Suspense","useSnackbar","Box","Typography","Button","CircularProgress","Alert","Stack","Avatar","Paper","CameraAlt","CheckCircleOutline","ErrorOutline","Person","Replay","loadModels","detectFace","jsxDEV","_jsxDEV","Fragment","_Fragment","Webcam","_c","_c2","videoConstraints","width","ideal","height","facingMode","FaceRegistrationComponent","onFaceDataCapture","requiredImages","_s","webcamRef","modelsLoaded","setModelsLoaded","modelLoadingError","setModelLoadingError","cameraReady","setCameraReady","cameraError","setCameraError","capturedImages","setCapturedImages","isProcessing","setIsProcessing","captureError","setCaptureError","enqueueSnackbar","initModels","console","log","err","error","variant","handleUserMedia","handleUserMediaError","errorMsg","captureImage","current","reason","length","imageSrc","getScreenshot","Error","detections","descriptor","warn","newImageData","img","Array","from","updatedImages","autoHideDuration","resetCapture","renderCameraView","elevation","sx","position","maxWidth","aspectRatio","margin","overflow","bgcolor","border","borderColor","children","fallback","top","left","transform","fileName","_jsxFileName","lineNumber","columnNumber","audio","ref","screenshotFormat","onUserMedia","onUserMediaError","style","display","objectFit","right","bottom","backgroundColor","flexDirection","justifyContent","alignItems","color","textAlign","p","mb","renderCaptureControls","mt","startIcon","onClick","disabled","mr","size","severity","renderImagePreviews","gutterBottom","direction","spacing","flexWrap","map","imgData","index","src","Math","max","_","i","icon","fontSize","_c3","$RefreshReg$"],"sources":["C:/Users/kasiz/Documents/Studying/FaceReg/frontend/src/components/FaceRegistrationComponent.js"],"sourcesContent":["import React, { useState, useEffect, useRef, lazy, Suspense } from \"react\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Button,\r\n  CircularProgress,\r\n  Alert,\r\n  Stack,\r\n  Avatar,\r\n  Paper,\r\n} from \"@mui/material\";\r\nimport {\r\n  CameraAlt,\r\n  CheckCircleOutline,\r\n  ErrorOutline,\r\n  Person,\r\n  Replay,\r\n} from \"@mui/icons-material\";\r\nimport { loadModels, detectFace } from \"../utils/faceUtils\";\r\n// import * as faceapi from \"face-api.js\"; // Removed real-time landmark logic\r\n\r\n// Lazy load Webcam\r\nconst Webcam = lazy(() => import(\"react-webcam\"));\r\n\r\n// Consistent video constraints\r\nconst videoConstraints = {\r\n  width: { ideal: 480 }, // Slightly larger for better capture\r\n  height: { ideal: 360 },\r\n  facingMode: \"user\",\r\n};\r\n\r\nconst FaceRegistrationComponent = ({\r\n  onFaceDataCapture,\r\n  requiredImages = 3,\r\n}) => {\r\n  // Refs\r\n  const webcamRef = useRef(null);\r\n\r\n  // State\r\n  const [modelsLoaded, setModelsLoaded] = useState(false);\r\n  const [modelLoadingError, setModelLoadingError] = useState(null);\r\n  const [cameraReady, setCameraReady] = useState(false);\r\n  const [cameraError, setCameraError] = useState(null);\r\n  const [capturedImages, setCapturedImages] = useState([]); // Array of { img: base64, descriptor: Float32Array }\r\n  const [isProcessing, setIsProcessing] = useState(false); // For capture operation only\r\n  const [captureError, setCaptureError] = useState(\"\");\r\n  const { enqueueSnackbar } = useSnackbar();\r\n\r\n  // 1. Load face recognition models on mount\r\n  useEffect(() => {\r\n    const initModels = async () => {\r\n      setModelLoadingError(null); // Reset error\r\n      try {\r\n        console.log(\"[FaceComponent] Loading models...\");\r\n        await loadModels();\r\n        setModelsLoaded(true);\r\n        console.log(\"[FaceComponent] Models loaded successfully.\");\r\n        // enqueueSnackbar(\"Đã tải mô hình nhận diện\", { variant: \"success\", autoHideDuration: 1500 });\r\n      } catch (err) {\r\n        console.error(\"[FaceComponent] Error loading models:\", err);\r\n        setModelLoadingError(\r\n          \"Không thể tải mô hình nhận diện. Vui lòng thử tải lại trang.\"\r\n        );\r\n        enqueueSnackbar(\"Lỗi tải mô hình nhận diện\", { variant: \"error\" });\r\n      }\r\n    };\r\n    initModels();\r\n  }, [enqueueSnackbar]); // Run only once on mount\r\n\r\n  // 2. Handle camera state changes\r\n  const handleUserMedia = () => {\r\n    console.log(\"[FaceComponent] Camera is ready.\");\r\n    setCameraReady(true);\r\n    setCameraError(null); // Clear previous camera error\r\n  };\r\n\r\n  const handleUserMediaError = (error) => {\r\n    console.error(\"[FaceComponent] Camera error:\", error);\r\n    setCameraReady(false);\r\n    const errorMsg =\r\n      \"Không thể truy cập camera. Vui lòng cấp quyền và thử lại.\";\r\n    setCameraError(errorMsg);\r\n    enqueueSnackbar(errorMsg, { variant: \"error\" });\r\n  };\r\n\r\n  // 3. Capture and detect face\r\n  const captureImage = async () => {\r\n    // Basic checks\r\n    if (!webcamRef.current || !cameraReady || isProcessing || !modelsLoaded) {\r\n      let reason = \"Chưa sẵn sàng\";\r\n      if (!cameraReady) reason = \"Camera chưa sẵn sàng\";\r\n      else if (isProcessing) reason = \"Đang xử lý\";\r\n      else if (!modelsLoaded) reason = \"Mô hình chưa tải xong\";\r\n      enqueueSnackbar(`Không thể chụp ảnh: ${reason}`, { variant: \"warning\" });\r\n      return;\r\n    }\r\n    if (capturedImages.length >= requiredImages) {\r\n      enqueueSnackbar(`Đã chụp đủ ${requiredImages} ảnh.`, { variant: \"info\" });\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    setCaptureError(\"\"); // Clear previous capture error\r\n\r\n    try {\r\n      const imageSrc = webcamRef.current.getScreenshot({\r\n        width: videoConstraints.width.ideal,\r\n        height: videoConstraints.height.ideal,\r\n      });\r\n      if (!imageSrc) {\r\n        throw new Error(\"Không thể chụp ảnh từ webcam.\");\r\n      }\r\n\r\n      // Perform face detection\r\n      console.log(\"[FaceComponent] Detecting face in captured image...\");\r\n      const detections = await detectFace(imageSrc);\r\n\r\n      if (!detections || !detections.descriptor) {\r\n        console.warn(\r\n          \"[FaceComponent] Face detection failed or no descriptor found.\"\r\n        );\r\n        enqueueSnackbar(\r\n          \"Không phát hiện được khuôn mặt rõ ràng. Hãy thử lại.\",\r\n          { variant: \"warning\" }\r\n        );\r\n        setIsProcessing(false); // Allow retry\r\n        return;\r\n      }\r\n      console.log(\"[FaceComponent] Face detected successfully.\");\r\n\r\n      // Store image and descriptor\r\n      const newImageData = {\r\n        img: imageSrc,\r\n        descriptor: Array.from(detections.descriptor), // Ensure serializable\r\n      };\r\n      const updatedImages = [...capturedImages, newImageData];\r\n      setCapturedImages(updatedImages);\r\n\r\n      enqueueSnackbar(`Đã chụp ảnh ${updatedImages.length}/${requiredImages}`, {\r\n        variant: \"success\",\r\n        autoHideDuration: 1500,\r\n      });\r\n\r\n      // If enough images captured, notify parent immediately\r\n      if (updatedImages.length >= requiredImages) {\r\n        console.log(\r\n          `[FaceComponent] Captured ${requiredImages} images. Calling onFaceDataCapture.`\r\n        );\r\n        onFaceDataCapture(updatedImages); // Pass all captured data\r\n        enqueueSnackbar(`Đã chụp đủ ${requiredImages} ảnh!`, {\r\n          variant: \"info\",\r\n        });\r\n      }\r\n    } catch (err) {\r\n      console.error(\"[FaceComponent] Error capturing image:\", err);\r\n      const errorMsg = \"Lỗi khi chụp ảnh. Vui lòng thử lại.\";\r\n      setCaptureError(errorMsg);\r\n      enqueueSnackbar(errorMsg, { variant: \"error\" });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  // 4. Reset capture\r\n  const resetCapture = () => {\r\n    console.log(\"[FaceComponent] Resetting capture.\");\r\n    setCapturedImages([]);\r\n    setCaptureError(\"\");\r\n    // Notify parent that data is cleared (optional, depends on parent needs)\r\n    // onFaceDataCapture(null); or onFaceDataCapture([]);\r\n    enqueueSnackbar(\"Đã xóa ảnh đã chụp, bạn có thể chụp lại.\", {\r\n      variant: \"info\",\r\n    });\r\n  };\r\n\r\n  // --- Render Logic ---\r\n\r\n  const renderCameraView = () => (\r\n    <Paper\r\n      elevation={2}\r\n      sx={{\r\n        position: \"relative\",\r\n        width: \"100%\",\r\n        maxWidth: `${videoConstraints.width.ideal}px`,\r\n        aspectRatio: `${videoConstraints.width.ideal} / ${videoConstraints.height.ideal}`,\r\n        margin: \"16px auto\",\r\n        overflow: \"hidden\",\r\n        bgcolor: \"grey.200\",\r\n        border: cameraError ? \"2px solid red\" : \"1px solid\",\r\n        borderColor: \"divider\",\r\n      }}\r\n    >\r\n      <Suspense\r\n        fallback={\r\n          <Box\r\n            sx={{\r\n              position: \"absolute\",\r\n              top: \"50%\",\r\n              left: \"50%\",\r\n              transform: \"translate(-50%, -50%)\",\r\n            }}\r\n          >\r\n            <CircularProgress />\r\n          </Box>\r\n        }\r\n      >\r\n        <Webcam\r\n          audio={false}\r\n          ref={webcamRef}\r\n          screenshotFormat=\"image/jpeg\"\r\n          videoConstraints={videoConstraints}\r\n          onUserMedia={handleUserMedia}\r\n          onUserMediaError={handleUserMediaError}\r\n          style={{\r\n            display: \"block\",\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            objectFit: \"cover\",\r\n          }}\r\n        />\r\n      </Suspense>\r\n\r\n      {/* Loading/Error Overlay */}\r\n      {(!modelsLoaded || !cameraReady || cameraError || modelLoadingError) && (\r\n        <Box\r\n          sx={{\r\n            position: \"absolute\",\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundColor: \"rgba(0, 0, 0, 0.5)\",\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            color: \"white\",\r\n            textAlign: \"center\",\r\n            p: 2,\r\n          }}\r\n        >\r\n          <CircularProgress color=\"inherit\" sx={{ mb: 2 }} />\r\n          {modelLoadingError && (\r\n            <Typography variant=\"body2\" color=\"error\">\r\n              {modelLoadingError}\r\n            </Typography>\r\n          )}\r\n          {cameraError && (\r\n            <Typography variant=\"body2\" color=\"error\">\r\n              {cameraError}\r\n            </Typography>\r\n          )}\r\n          {!modelLoadingError && !cameraError && !modelsLoaded && (\r\n            <Typography>Đang tải mô hình...</Typography>\r\n          )}\r\n          {!modelLoadingError &&\r\n            !cameraError &&\r\n            modelsLoaded &&\r\n            !cameraReady && <Typography>Đang khởi động camera...</Typography>}\r\n        </Box>\r\n      )}\r\n    </Paper>\r\n  );\r\n\r\n  const renderCaptureControls = () => (\r\n    <Box sx={{ textAlign: \"center\", mt: 2 }}>\r\n      <Button\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        startIcon={<CameraAlt />}\r\n        onClick={captureImage}\r\n        disabled={\r\n          !cameraReady ||\r\n          !modelsLoaded ||\r\n          isProcessing ||\r\n          capturedImages.length >= requiredImages ||\r\n          !!cameraError ||\r\n          !!modelLoadingError\r\n        }\r\n        sx={{ mb: 1, mr: 1 }}\r\n      >\r\n        {isProcessing ? (\r\n          <CircularProgress size={24} color=\"inherit\" />\r\n        ) : (\r\n          `Chụp ảnh (${capturedImages.length}/${requiredImages})`\r\n        )}\r\n      </Button>\r\n      <Button\r\n        variant=\"outlined\"\r\n        color=\"warning\"\r\n        startIcon={<Replay />}\r\n        onClick={resetCapture}\r\n        disabled={capturedImages.length === 0 || isProcessing}\r\n        sx={{ mb: 1 }}\r\n      >\r\n        Chụp lại\r\n      </Button>\r\n      {captureError && (\r\n        <Alert severity=\"error\" sx={{ mt: 2, textAlign: \"left\" }}>\r\n          {captureError}\r\n        </Alert>\r\n      )}\r\n    </Box>\r\n  );\r\n\r\n  const renderImagePreviews = () =>\r\n    capturedImages.length > 0 && (\r\n      <Box sx={{ mt: 2, textAlign: \"center\" }}>\r\n        <Typography variant=\"caption\" display=\"block\" gutterBottom>\r\n          Ảnh đã chụp:\r\n        </Typography>\r\n        <Stack\r\n          direction=\"row\"\r\n          spacing={1}\r\n          justifyContent=\"center\"\r\n          flexWrap=\"wrap\"\r\n        >\r\n          {capturedImages.map((imgData, index) => (\r\n            <Avatar\r\n              key={index}\r\n              src={imgData.img}\r\n              sx={{ width: 56, height: 56 }}\r\n            />\r\n          ))}\r\n          {/* Placeholders for remaining slots */}\r\n          {[...Array(Math.max(0, requiredImages - capturedImages.length))].map(\r\n            (_, i) => (\r\n              <Avatar\r\n                key={`placeholder-${i}`}\r\n                sx={{ width: 56, height: 56, bgcolor: \"grey.300\" }}\r\n              >\r\n                <Person />\r\n              </Avatar>\r\n            )\r\n          )}\r\n        </Stack>\r\n      </Box>\r\n    );\r\n\r\n  // --- Main Component Render ---\r\n  return (\r\n    <Box>\r\n      {/* Show general loading/error before camera */}\r\n      {!modelsLoaded && !modelLoadingError && (\r\n        <Box\r\n          sx={{\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            p: 2,\r\n          }}\r\n        >\r\n          <CircularProgress size={20} sx={{ mr: 1 }} />\r\n          <Typography>Đang tải mô hình nhận diện...</Typography>\r\n        </Box>\r\n      )}\r\n      {modelLoadingError && (\r\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n          {modelLoadingError}\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Render Camera and Controls once models attempt to load */}\r\n      {modelsLoaded && !modelLoadingError && (\r\n        <>\r\n          {renderCameraView()}\r\n          {renderCaptureControls()}\r\n          {renderImagePreviews()}\r\n        </>\r\n      )}\r\n      {/* Optional: Add a success message when all images are captured */}\r\n      {capturedImages.length >= requiredImages && (\r\n        <Alert\r\n          severity=\"success\"\r\n          icon={<CheckCircleOutline fontSize=\"inherit\" />}\r\n          sx={{ mt: 2 }}\r\n        >\r\n          Đã chụp đủ {requiredImages} ảnh. Bạn có thể tiếp tục.\r\n        </Alert>\r\n      )}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default FaceRegistrationComponent;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}