{"ast":null,"code":"import React,{useState}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{Outlet,useNavigate}from\"react-router-dom\";import{AppBar,Box,Toolbar,IconButton,Typography,Menu,MenuItem,Avatar,Drawer,List,ListItem,ListItemIcon,ListItemText,Divider,Container,useMediaQuery,useTheme}from\"@mui/material\";import{Menu as MenuIcon,Dashboard,School,Person,Settings,People,AccountCircle,Logout,CalendarToday,ListAlt,Home,Face,Place,Domain,Groups}from\"@mui/icons-material\";import{logout}from\"../redux/slices/authSlice\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MainLayout=()=>{var _user$full_name;const dispatch=useDispatch();const navigate=useNavigate();const theme=useTheme();const isMobile=useMediaQuery(theme.breakpoints.down(\"md\"));const{user}=useSelector(state=>state.auth);const[drawerOpen,setDrawerOpen]=useState(false);const[anchorEl,setAnchorEl]=useState(null);const handleDrawerToggle=()=>{setDrawerOpen(!drawerOpen);};const handleProfileMenuOpen=event=>{setAnchorEl(event.currentTarget);};const handleMenuClose=()=>{setAnchorEl(null);};const handleLogout=()=>{handleMenuClose();dispatch(logout());navigate(\"/login\");};const handleProfile=()=>{handleMenuClose();navigate(\"/profile\");};// Danh sách menu dựa vào vai trò người dùng\nconst getMenuItems=()=>{const menuItems=[{text:\"Trang chủ\",icon:/*#__PURE__*/_jsx(Dashboard,{}),path:\"/dashboard\",roles:[\"admin\",\"teacher\",\"student\"]},{text:\"Hồ sơ cá nhân\",icon:/*#__PURE__*/_jsx(Person,{}),path:\"/profile\",roles:[\"admin\",\"teacher\",\"student\"]}];// Menu cho sinh viên\nif((user===null||user===void 0?void 0:user.role)===\"student\"){menuItems.push({text:\"Đăng ký khuôn mặt\",icon:/*#__PURE__*/_jsx(Face,{}),path:\"/register-face\",roles:[\"student\"]},{text:\"Danh sách lớp học\",icon:/*#__PURE__*/_jsx(School,{}),path:\"/student/classes\",roles:[\"student\"]});}// Menu cho giáo viên\nif((user===null||user===void 0?void 0:user.role)===\"teacher\"){menuItems.push({text:\"Quản lý lớp học\",icon:/*#__PURE__*/_jsx(School,{}),path:\"/teacher/classes\",roles:[\"teacher\"]},{text:\"Quản lý lớp chính\",icon:/*#__PURE__*/_jsx(Groups,{}),path:\"/teacher/main-class\",roles:[\"teacher\"]});}// Menu cho admin\nif((user===null||user===void 0?void 0:user.role)===\"admin\"){menuItems.push({text:\"Quản lý người dùng\",icon:/*#__PURE__*/_jsx(People,{}),path:\"/admin/users\",roles:[\"admin\"]},{text:\"Quản lý lớp học\",icon:/*#__PURE__*/_jsx(School,{}),path:\"/admin/classes\",roles:[\"admin\"]},{text:\"Quản lý khoa\",icon:/*#__PURE__*/_jsx(ListAlt,{}),path:\"/admin/departments\",roles:[\"admin\"]},{text:\"Quản lý học kỳ\",icon:/*#__PURE__*/_jsx(CalendarToday,{}),path:\"/admin/semesters\",roles:[\"admin\"]},{text:\"Quản lý môn học\",icon:/*#__PURE__*/_jsx(ListAlt,{}),path:\"/admin/subjects\",roles:[\"admin\"]},{text:\"Quản lý cơ sở vật chất\",icon:/*#__PURE__*/_jsx(Domain,{}),path:\"/admin/facilities\",roles:[\"admin\"]});}return menuItems.filter(item=>item.roles.includes(user===null||user===void 0?void 0:user.role));};const drawer=/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",alignItems:\"center\",padding:2},children:[/*#__PURE__*/_jsx(School,{sx:{mr:1}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",noWrap:true,component:\"div\",children:\"FaceReg\"})]}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(List,{children:getMenuItems().map(item=>/*#__PURE__*/_jsxs(ListItem,{button:true,onClick:()=>{navigate(item.path);if(isMobile){setDrawerOpen(false);}},children:[/*#__PURE__*/_jsx(ListItemIcon,{children:item.icon}),/*#__PURE__*/_jsx(ListItemText,{primary:item.text})]},item.text))})]});const menuId=\"primary-search-account-menu\";const renderMenu=/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorEl,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},id:menuId,keepMounted:true,transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:Boolean(anchorEl),onClose:handleMenuClose,children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleProfile,children:[/*#__PURE__*/_jsx(AccountCircle,{sx:{mr:1}}),\" H\\u1ED3 s\\u01A1\"]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleLogout,children:[/*#__PURE__*/_jsx(Logout,{sx:{mr:1}}),\" \\u0110\\u0103ng xu\\u1EA5t\"]})]});return/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\"},children:[/*#__PURE__*/_jsx(AppBar,{position:\"fixed\",sx:{zIndex:theme=>theme.zIndex.drawer+1},children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",\"aria-label\":\"open drawer\",edge:\"start\",onClick:handleDrawerToggle,sx:{mr:2},children:/*#__PURE__*/_jsx(MenuIcon,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",noWrap:true,component:\"div\",sx:{display:{xs:\"none\",sm:\"block\"}},children:\"H\\u1EC7 Th\\u1ED1ng \\u0110i\\u1EC3m Danh B\\u1EB1ng Khu\\xF4n M\\u1EB7t\"}),/*#__PURE__*/_jsx(Box,{sx:{flexGrow:1}}),/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mr:2},children:user===null||user===void 0?void 0:user.full_name}),/*#__PURE__*/_jsx(IconButton,{size:\"large\",edge:\"end\",\"aria-label\":\"account of current user\",\"aria-controls\":menuId,\"aria-haspopup\":\"true\",onClick:handleProfileMenuOpen,color:\"inherit\",children:user!==null&&user!==void 0&&user.avatar_url?/*#__PURE__*/_jsx(Avatar,{alt:user===null||user===void 0?void 0:user.full_name,src:user===null||user===void 0?void 0:user.avatar_url,sx:{width:32,height:32}}):/*#__PURE__*/_jsx(Avatar,{sx:{width:32,height:32},children:(user===null||user===void 0?void 0:(_user$full_name=user.full_name)===null||_user$full_name===void 0?void 0:_user$full_name.charAt(0))||\"U\"})})]})]})}),renderMenu,/*#__PURE__*/_jsxs(Box,{component:\"nav\",sx:{width:{md:240},flexShrink:{md:0}},children:[/*#__PURE__*/_jsx(Drawer,{variant:\"temporary\",open:drawerOpen,onClose:handleDrawerToggle,ModalProps:{keepMounted:true// Better open performance on mobile\n},sx:{display:{xs:\"block\",md:\"none\"},\"& .MuiDrawer-paper\":{boxSizing:\"border-box\",width:240}},children:drawer}),/*#__PURE__*/_jsx(Drawer,{variant:\"permanent\",sx:{display:{xs:\"none\",md:\"block\"},\"& .MuiDrawer-paper\":{boxSizing:\"border-box\",width:240}},open:true,children:drawer})]}),/*#__PURE__*/_jsx(Box,{component:\"main\",sx:{flexGrow:1,p:3,width:{md:`calc(100% - 240px)`},mt:\"64px\"},children:/*#__PURE__*/_jsx(Container,{maxWidth:\"xl\",children:/*#__PURE__*/_jsx(Outlet,{})})})]});};export default MainLayout;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}