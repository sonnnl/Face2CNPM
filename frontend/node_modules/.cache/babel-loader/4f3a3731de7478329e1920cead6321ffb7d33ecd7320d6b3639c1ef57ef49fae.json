{"ast":null,"code":"import*as faceapi from\"face-api.js\";let isModelsLoaded=false;/**\r\n * Tải các model face-api.js\r\n * @returns {Promise<boolean>}\r\n */export const loadModels=async()=>{if(isModelsLoaded){return true;}try{const MODEL_URL=\"/models\";await Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL)]);isModelsLoaded=true;return true;}catch(error){console.error(\"Error loading models:\",error);throw error;}};/**\r\n * Phát hiện khuôn mặt từ hình ảnh\r\n * @param {string} imageData - Base64 image data\r\n * @returns {Promise<Object>} - Kết quả phát hiện khuôn mặt\r\n */export const detectFace=async imageData=>{if(!isModelsLoaded){await loadModels();}try{const img=await faceapi.fetchImage(imageData);const detections=await faceapi.detectSingleFace(img,new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceDescriptor();return detections;}catch(error){console.error(\"Error detecting face:\",error);throw error;}};/**\r\n * Tính toán khoảng cách Euclid giữa các đặc trưng khuôn mặt\r\n * @param {Float32Array} descriptor1 - Đặc trưng khuôn mặt 1\r\n * @param {Float32Array} descriptor2 - Đặc trưng khuôn mặt 2\r\n * @returns {number} - Khoảng cách (0-1, càng nhỏ càng giống nhau)\r\n */export const getFaceDistance=(descriptor1,descriptor2)=>{return faceapi.euclideanDistance(descriptor1,descriptor2);};/**\r\n * Kiểm tra xem khuôn mặt có phải là cùng một người không\r\n * @param {Float32Array} descriptor1 - Đặc trưng khuôn mặt 1\r\n * @param {Float32Array} descriptor2 - Đặc trưng khuôn mặt 2\r\n * @param {number} threshold - Ngưỡng để xác định là cùng một người (mặc định: 0.6)\r\n * @returns {boolean} - Có phải cùng một người không\r\n */export const isSameFace=function(descriptor1,descriptor2){let threshold=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0.6;const distance=getFaceDistance(descriptor1,descriptor2);return distance<threshold;};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}