{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{useSelector}from\"react-redux\";import{useSnackbar}from\"notistack\";import axios from\"axios\";import{Box,Typography,Card,CardContent,Grid,Paper,Button,TextField,CircularProgress,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,TablePagination,InputAdornment,FormControl,InputLabel,Select,MenuItem,Chip,Divider,Dialog,DialogTitle,DialogContent,DialogActions,IconButton,FormHelperText}from\"@mui/material\";import{Search,School,CalendarToday,Class,Add,BarChart,Room as RoomIcon,Home as HomeIcon,Business as BuildingIcon,Event}from\"@mui/icons-material\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||\"http://localhost:5000/api\";const TeacherClassesPage=()=>{const navigate=useNavigate();const{enqueueSnackbar}=useSnackbar();const{user,token}=useSelector(state=>state.auth);// State cho dữ liệu\nconst[classes,setClasses]=useState([]);const[semesters,setSemesters]=useState([]);const[isLoading,setIsLoading]=useState(true);const[totalClasses,setTotalClasses]=useState(0);// State cho tìm kiếm và phân trang\nconst[search,setSearch]=useState(\"\");const[semester,setSemester]=useState(\"\");const[page,setPage]=useState(0);const[rowsPerPage,setRowsPerPage]=useState(10);// State cho dialog thêm lớp học\nconst[openAddClassDialog,setOpenAddClassDialog]=useState(false);const[isSubmitting,setIsSubmitting]=useState(false);const[newClass,setNewClass]=useState({class_name:\"\",class_code:\"\",subject_id:\"\",teacher_id:(user===null||user===void 0?void 0:user._id)||\"\",main_class_id:\"\",semester_id:\"\",total_sessions:15,room_id:\"\",course_start_date:\"\",course_end_date:\"\",auto_generate_sessions:true,schedule:[]});// State cho danh sách dữ liệu tham chiếu\nconst[subjects,setSubjects]=useState([]);const[mainClasses,setMainClasses]=useState([]);const[campuses,setCampuses]=useState([]);const[buildings,setBuildings]=useState([]);const[rooms,setRooms]=useState([]);const[selectedCampus,setSelectedCampus]=useState(\"\");const[selectedBuilding,setSelectedBuilding]=useState(\"\");const[scheduleDays,setScheduleDays]=useState([{day_of_week:1,start_period:1,end_period:2,start_time:\"07:00\",end_time:\"08:40\",room_id:\"\",is_recurring:true,specific_dates:[],excluded_dates:[]}]);// Load dữ liệu ban đầu\nuseEffect(()=>{const fetchInitialData=async()=>{try{setIsLoading(true);// Load các học kỳ\nconst semestersResponse=await axios.get(`${API_URL}/semesters`,{headers:{Authorization:`Bearer ${token}`}});setSemesters(semestersResponse.data.data||[]);// Load lớp học theo mặc định\nawait fetchClasses();}catch(error){console.error(\"Lỗi khi tải dữ liệu:\",error);enqueueSnackbar(\"Lỗi khi tải dữ liệu\",{variant:\"error\"});}finally{setIsLoading(false);}};fetchInitialData();},[token,enqueueSnackbar]);// Tải danh sách lớp học\nconst fetchClasses=async()=>{try{setIsLoading(true);let url=`${API_URL}/classes/teaching/teacher/${user._id}?page=${page+1}&limit=${rowsPerPage}`;if(search){url+=`&search=${encodeURIComponent(search)}`;}if(semester){url+=`&semester_id=${semester}`;}const response=await axios.get(url,{headers:{Authorization:`Bearer ${token}`}});// Lưu nhật ký để gỡ lỗi\nconsole.log(\"Danh sách lớp học đã tải:\",response.data.data);setClasses(response.data.data||[]);setTotalClasses(response.data.count||0);}catch(error){console.error(\"Lỗi khi tải danh sách lớp học:\",error);enqueueSnackbar(\"Lỗi khi tải danh sách lớp học\",{variant:\"error\"});}finally{setIsLoading(false);}};// Xử lý thay đổi trang hoặc số dòng mỗi trang\nuseEffect(()=>{fetchClasses();},[page,rowsPerPage,token]);// Tải dữ liệu tham chiếu cho dialog thêm lớp\nconst fetchReferenceData=async()=>{try{const[subjectsRes,mainClassesRes,campusesRes]=await Promise.all([axios.get(`${API_URL}/subjects`,{headers:{Authorization:`Bearer ${token}`}}),axios.get(`${API_URL}/classes/main?all=true`,{headers:{Authorization:`Bearer ${token}`}}),axios.get(`${API_URL}/facilities/campus`,{headers:{Authorization:`Bearer ${token}`}})]);setSubjects(subjectsRes.data.data||[]);setMainClasses(mainClassesRes.data.data||[]);setCampuses(campusesRes.data.data||[]);}catch(error){console.error(\"Lỗi khi tải dữ liệu tham chiếu:\",error);enqueueSnackbar(\"Lỗi khi tải dữ liệu tham chiếu\",{variant:\"error\"});}};// Tải danh sách tòa nhà khi chọn campus\nconst fetchBuildings=async campusId=>{if(!campusId){setBuildings([]);setSelectedBuilding(\"\");return;}try{const response=await axios.get(`${API_URL}/facilities/buildings/campus/${campusId}`,{headers:{Authorization:`Bearer ${token}`}});setBuildings(response.data.data||[]);}catch(error){console.error(\"Lỗi khi tải danh sách tòa nhà:\",error);enqueueSnackbar(\"Lỗi khi tải danh sách tòa nhà\",{variant:\"error\"});}};// Tải danh sách phòng học khi chọn tòa nhà\nconst fetchRooms=async buildingId=>{if(!buildingId){setRooms([]);return;}try{const response=await axios.get(`${API_URL}/facilities/rooms/building/${buildingId}`,{headers:{Authorization:`Bearer ${token}`}});setRooms(response.data.data||[]);}catch(error){console.error(\"Lỗi khi tải danh sách phòng học:\",error);enqueueSnackbar(\"Lỗi khi tải danh sách phòng học\",{variant:\"error\"});}};// Xử lý tìm kiếm\nconst handleSearch=()=>{setPage(0);// Reset về trang đầu tiên\nfetchClasses();};// Xử lý thay đổi trang\nconst handleChangePage=(event,newPage)=>{setPage(newPage);};// Xử lý thay đổi số dòng mỗi trang\nconst handleChangeRowsPerPage=event=>{setRowsPerPage(parseInt(event.target.value,10));setPage(0);};// Xử lý khi nhấn Enter trong ô tìm kiếm\nconst handleSearchKeyDown=e=>{if(e.key===\"Enter\"){handleSearch();}};// Lọc theo học kỳ hoặc năm học\nconst handleFilterChange=()=>{setPage(0);fetchClasses();};// Mở trang chi tiết lớp học\nconst handleViewClass=classId=>{// Kiểm tra classId có tồn tại không\nif(!classId){enqueueSnackbar(\"ID lớp học không hợp lệ\",{variant:\"error\"});return;}// Không kiểm tra định dạng ObjectId nữa, chấp nhận mọi định dạng ID từ BE\nnavigate(`/teacher/classes/${classId}`);};// Mở dialog thêm lớp học\nconst handleOpenAddClassDialog=()=>{fetchReferenceData();setOpenAddClassDialog(true);};// Đóng dialog thêm lớp học\nconst handleCloseAddClassDialog=()=>{setOpenAddClassDialog(false);resetNewClassForm();};// Reset form thêm lớp\nconst resetNewClassForm=()=>{setNewClass({class_name:\"\",class_code:\"\",subject_id:\"\",teacher_id:(user===null||user===void 0?void 0:user._id)||\"\",main_class_id:\"\",semester_id:\"\",total_sessions:15,room_id:\"\",course_start_date:\"\",course_end_date:\"\",auto_generate_sessions:true,schedule:[]});setSelectedCampus(\"\");setSelectedBuilding(\"\");setScheduleDays([{day_of_week:1,start_period:1,end_period:2,start_time:\"07:00\",end_time:\"08:40\",room_id:\"\",is_recurring:true,specific_dates:[],excluded_dates:[]}]);};// Xử lý thay đổi các trường thông tin lớp học\nconst handleNewClassChange=e=>{const{name,value}=e.target;setNewClass(prev=>({...prev,[name]:value}));};// Xử lý thay đổi campus\nconst handleCampusChange=e=>{const campusId=e.target.value;setSelectedCampus(campusId);fetchBuildings(campusId);setSelectedBuilding(\"\");setNewClass(prev=>({...prev,room_id:\"\"}));};// Xử lý thay đổi building\nconst handleBuildingChange=e=>{const buildingId=e.target.value;setSelectedBuilding(buildingId);fetchRooms(buildingId);setNewClass(prev=>({...prev,room_id:\"\"}));};// Xử lý thay đổi thông tin lịch học\nconst handleScheduleChange=(index,field,value)=>{const updatedSchedule=[...scheduleDays];updatedSchedule[index]={...updatedSchedule[index],[field]:value};setScheduleDays(updatedSchedule);// Tính lại ngày kết thúc khi lịch học thay đổi\nsetNewClass(prev=>({...prev,course_end_date:calculateEndDate(prev.course_start_date,updatedSchedule,prev.total_sessions)}));};// Thêm hàm lấy thứ trong tuần từ ngày\nconst getDayOfWeekFromDate=dateString=>{if(!dateString)return 1;// Mặc định là thứ 2 nếu không có ngày\nconst date=new Date(dateString);// getDay() trả về 0 cho Chủ Nhật, 1-6 cho Thứ 2 đến Thứ 7\nconst day=date.getDay();// Chuyển đổi để 0 = Chủ Nhật, 1 = Thứ Hai, ...\nreturn day;};// Thêm hàm để lấy tên của thứ\nconst getDayOfWeekName=dayOfWeek=>{const days=[\"Chủ Nhật\",\"Thứ Hai\",\"Thứ Ba\",\"Thứ Tư\",\"Thứ Năm\",\"Thứ Sáu\",\"Thứ Bảy\"];return days[dayOfWeek];};// Thêm hàm để lấy tên của thứ\nconst addScheduleDay=()=>{// Lấy ngày bắt đầu\nconst startDate=newClass.course_start_date;if(!startDate){enqueueSnackbar(\"Vui lòng chọn ngày bắt đầu trước\",{variant:\"warning\"});return;}// Lấy thứ từ ngày bắt đầu\nconst baseDayOfWeek=getDayOfWeekFromDate(startDate);// Tìm thứ tiếp theo chưa có trong lịch\nconst existingDays=scheduleDays.map(day=>day.day_of_week);let nextDay=(baseDayOfWeek+1)%7;// Thứ tiếp theo\n// Tìm một thứ chưa có trong lịch hiện tại\nfor(let i=0;i<7;i++){if(!existingDays.includes(nextDay)){break;}nextDay=(nextDay+1)%7;}// Nếu đã có đủ 7 ngày trong tuần, thì dùng thứ 2\nif(existingDays.length>=7){nextDay=1;}const updatedSchedule=[...scheduleDays,{day_of_week:nextDay,start_period:1,end_period:2,start_time:\"07:00\",end_time:\"08:40\",room_id:newClass.room_id,is_recurring:true,specific_dates:[],excluded_dates:[]}];setScheduleDays(updatedSchedule);// Tính lại ngày kết thúc sau khi thêm buổi học\nsetNewClass(prev=>({...prev,course_end_date:calculateEndDate(prev.course_start_date,updatedSchedule,prev.total_sessions)}));};// Thêm một hàm để tính ngày kết thúc dựa trên ngày bắt đầu và lịch học\nconst calculateEndDate=(startDate,schedule,totalSessions)=>{if(!startDate||!schedule||schedule.length===0||!totalSessions){return\"\";}try{// Chuyển ngày bắt đầu thành đối tượng Date\nconst start=new Date(startDate);if(isNaN(start.getTime())){return\"\";}// Tổng số tuần cần thiết = tổng số buổi học / số buổi học mỗi tuần\nconst sessionsPerWeek=schedule.length;const weeksNeeded=Math.ceil(totalSessions/sessionsPerWeek);// Tạo mảng chứa các ngày trong tuần từ lịch học (0-6, với 0 là Chủ Nhật)\nconst daysOfWeek=schedule.map(day=>day.day_of_week);// Sắp xếp các ngày trong tuần\ndaysOfWeek.sort((a,b)=>a-b);// Tìm ngày đầu tiên trong lịch học sau ngày bắt đầu\nlet currentDate=new Date(start);// Đếm số buổi học đã xếp lịch\nlet sessionCount=0;// Lặp qua từng tuần\nfor(let week=0;week<weeksNeeded*2;week++){// Nhân 2 để đảm bảo đủ số buổi\n// Lặp qua các ngày trong tuần từ lịch học\nfor(let dayIndex=0;dayIndex<daysOfWeek.length;dayIndex++){const targetDayOfWeek=daysOfWeek[dayIndex];// Tìm ngày tiếp theo có thứ phù hợp\nwhile(currentDate.getDay()!==targetDayOfWeek){currentDate.setDate(currentDate.getDate()+1);}sessionCount++;// Nếu đã đủ số buổi học, trả về ngày hiện tại\nif(sessionCount>=totalSessions){return currentDate.toISOString().split(\"T\")[0];}// Di chuyển đến ngày tiếp theo\ncurrentDate.setDate(currentDate.getDate()+1);}}// Nếu không tính được, trả về chuỗi rỗng\nreturn\"\";}catch(error){console.error(\"Lỗi khi tính ngày kết thúc:\",error);return\"\";}};// Cập nhật hàm xử lý thay đổi ngày bắt đầu\nconst handleStartDateChange=e=>{const startDate=e.target.value;// Lấy thứ từ ngày bắt đầu\nconst dayOfWeek=getDayOfWeekFromDate(startDate);// Cập nhật lịch học với thứ mới\nconst updatedSchedule=[{day_of_week:dayOfWeek,start_period:1,end_period:2,start_time:\"07:00\",end_time:\"08:40\",room_id:newClass.room_id,is_recurring:true,specific_dates:[],excluded_dates:[]}];// Cập nhật lịch học\nsetScheduleDays(updatedSchedule);// Cập nhật ngày bắt đầu và tính ngày kết thúc\nsetNewClass(prev=>({...prev,course_start_date:startDate,course_end_date:calculateEndDate(startDate,updatedSchedule,prev.total_sessions)}));};// Cập nhật hàm xử lý thay đổi số buổi học\nconst handleTotalSessionsChange=e=>{const totalSessions=e.target.value;setNewClass(prev=>({...prev,total_sessions:totalSessions,// Tính lại ngày kết thúc khi thay đổi số buổi học\ncourse_end_date:calculateEndDate(prev.course_start_date,scheduleDays,totalSessions)}));};// Tạo lớp học mới\nconst handleCreateClass=async()=>{// Kiểm tra dữ liệu nhập\nif(!newClass.class_name||!newClass.class_code||!newClass.subject_id||!newClass.semester_id||!newClass.total_sessions||!newClass.course_start_date){enqueueSnackbar(\"Vui lòng điền đầy đủ thông tin bắt buộc\",{variant:\"warning\"});return;}try{setIsSubmitting(true);// Cập nhật room_id cho mỗi lịch học nếu chưa có\nconst updatedSchedule=scheduleDays.map(schedule=>({...schedule,room_id:schedule.room_id||newClass.room_id}));const classData={...newClass,schedule:updatedSchedule,teacher_id:user._id};const response=await axios.post(`${API_URL}/classes/teaching`,classData,{headers:{Authorization:`Bearer ${token}`}});enqueueSnackbar(\"Tạo lớp học thành công\",{variant:\"success\"});handleCloseAddClassDialog();fetchClasses();// Tải lại danh sách lớp\n}catch(error){var _error$response,_error$response$data;console.error(\"Lỗi khi tạo lớp học:\",error);enqueueSnackbar(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||\"Lỗi khi tạo lớp học\",{variant:\"error\"});}finally{setIsSubmitting(false);}};// Thêm lại hàm removeScheduleDay\nconst removeScheduleDay=index=>{if(scheduleDays.length>1){const updatedSchedule=scheduleDays.filter((_,i)=>i!==index);setScheduleDays(updatedSchedule);// Tính lại ngày kết thúc sau khi xóa buổi học\nsetNewClass(prev=>({...prev,course_end_date:calculateEndDate(prev.course_start_date,updatedSchedule,prev.total_sessions)}));}};return/*#__PURE__*/_jsxs(Box,{sx:{padding:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",justifyContent:\"space-between\",mb:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",gutterBottom:true,sx:{fontWeight:\"bold\"},children:[/*#__PURE__*/_jsx(Class,{sx:{mr:1,verticalAlign:\"middle\"}}),\"Qu\\u1EA3n l\\xFD l\\u1EDBp h\\u1ECDc\"]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:handleOpenAddClassDialog,children:\"Th\\xEAm l\\u1EDBp h\\u1ECDc\"})]}),/*#__PURE__*/_jsx(Paper,{sx:{p:2,mb:3},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:5,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"T\\xECm ki\\u1EBFm l\\u1EDBp h\\u1ECDc\",variant:\"outlined\",value:search,onChange:e=>setSearch(e.target.value),onKeyDown:handleSearchKeyDown,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(Search,{})})}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:5,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,variant:\"outlined\",children:[/*#__PURE__*/_jsx(InputLabel,{children:\"H\\u1ECDc k\\u1EF3\"}),/*#__PURE__*/_jsxs(Select,{value:semester,onChange:e=>{setSemester(e.target.value);handleFilterChange();},label:\"H\\u1ECDc k\\u1EF3\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"T\\u1EA5t c\\u1EA3 h\\u1ECDc k\\u1EF3\"}),semesters.map(sem=>/*#__PURE__*/_jsxs(MenuItem,{value:sem._id,children:[sem.name,\" (\",sem.academic_year||`${sem.year}-${sem.year+1}`,\")\"]},sem._id))]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:2,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",fullWidth:true,onClick:handleSearch,children:\"T\\xECm ki\\u1EBFm\"})})]})}),/*#__PURE__*/_jsx(Paper,{children:isLoading?/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",justifyContent:\"center\",p:3},children:/*#__PURE__*/_jsx(CircularProgress,{})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"T\\xEAn l\\u1EDBp\"}),/*#__PURE__*/_jsx(TableCell,{children:\"M\\xF4n h\\u1ECDc\"}),/*#__PURE__*/_jsx(TableCell,{children:\"K\\u1EF3 h\\u1ECDc\"}),/*#__PURE__*/_jsx(TableCell,{children:\"L\\u1EDBp ch\\xEDnh\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"S\\u1ED1 l\\u01B0\\u1EE3ng SV\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:classes.length>0?classes.map(classItem=>{var _classItem$students,_classItem$students2;return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:classItem.class_name})}),/*#__PURE__*/_jsx(TableCell,{children:classItem.subject_id?/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:classItem.subject_id.name}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:classItem.subject_id.code})]}):/*#__PURE__*/_jsx(Chip,{label:\"N/A\",size:\"small\",variant:\"outlined\"})}),/*#__PURE__*/_jsx(TableCell,{children:classItem.semester_id?/*#__PURE__*/_jsx(Chip,{label:classItem.semester_id.name,size:\"small\",color:\"info\",variant:\"outlined\"}):/*#__PURE__*/_jsx(Chip,{label:\"Kh\\xF4ng x\\xE1c \\u0111\\u1ECBnh\",size:\"small\",variant:\"outlined\",color:\"default\"})}),/*#__PURE__*/_jsx(TableCell,{children:classItem.main_class_id?/*#__PURE__*/_jsx(Chip,{label:classItem.main_class_id.name,size:\"small\",sx:{bgcolor:\"#e3f2fd\"}}):/*#__PURE__*/_jsx(Chip,{label:\"Kh\\xF4ng c\\xF3\",size:\"small\",variant:\"outlined\",color:\"default\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:/*#__PURE__*/_jsx(Chip,{label:((_classItem$students=classItem.students)===null||_classItem$students===void 0?void 0:_classItem$students.length)||0,color:((_classItem$students2=classItem.students)===null||_classItem$students2===void 0?void 0:_classItem$students2.length)>0?\"success\":\"default\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:classItem.status===\"đang học\"?/*#__PURE__*/_jsx(Chip,{label:\"\\u0110ang h\\u1ECDc\",color:\"success\",size:\"small\"}):classItem.status===\"đã kết thúc\"?/*#__PURE__*/_jsx(Chip,{label:\"\\u0110\\xE3 k\\u1EBFt th\\xFAc\",color:\"default\",size:\"small\"}):/*#__PURE__*/_jsx(Chip,{label:\"Ch\\u01B0a b\\u1EAFt \\u0111\\u1EA7u\",color:\"primary\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>handleViewClass(classItem._id),children:\"Chi ti\\u1EBFt\"})})]},classItem._id);}):/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:7,align:\"center\",children:\"Kh\\xF4ng c\\xF3 l\\u1EDBp h\\u1ECDc n\\xE0o.\"})})})]})}),/*#__PURE__*/_jsx(TablePagination,{rowsPerPageOptions:[5,10,25],component:\"div\",count:totalClasses,rowsPerPage:rowsPerPage,page:page,onPageChange:handleChangePage,onRowsPerPageChange:handleChangeRowsPerPage,labelRowsPerPage:\"D\\xF2ng m\\u1ED7i trang:\",labelDisplayedRows:_ref=>{let{from,to,count}=_ref;return`${from}-${to} trong số ${count!==-1?count:`hơn ${to}`}`;}})]})}),/*#__PURE__*/_jsxs(Dialog,{open:openAddClassDialog,onClose:handleCloseAddClassDialog,maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsxs(DialogTitle,{sx:{bgcolor:\"primary.main\",color:\"white\",fontWeight:\"bold\"},children:[/*#__PURE__*/_jsx(Add,{sx:{verticalAlign:\"middle\",mr:1}}),\"Th\\xEAm l\\u1EDBp h\\u1ECDc m\\u1EDBi\"]}),/*#__PURE__*/_jsx(DialogContent,{dividers:true,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{mt:1},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"T\\xEAn l\\u1EDBp\",name:\"class_name\",value:newClass.class_name,onChange:handleNewClassChange,required:true,variant:\"outlined\",placeholder:\"VD: L\\u1EADp tr\\xECnh web - Nh\\xF3m 1\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"M\\xE3 l\\u1EDBp\",name:\"class_code\",value:newClass.class_code,onChange:handleNewClassChange,required:true,variant:\"outlined\",placeholder:\"VD: WEB101-G1\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"M\\xF4n h\\u1ECDc\"}),/*#__PURE__*/_jsx(Select,{label:\"M\\xF4n h\\u1ECDc\",name:\"subject_id\",value:newClass.subject_id,onChange:handleNewClassChange,children:subjects.map(subject=>/*#__PURE__*/_jsxs(MenuItem,{value:subject._id,children:[subject.name,\" (\",subject.code,\")\"]},subject._id))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"H\\u1ECDc k\\u1EF3\"}),/*#__PURE__*/_jsx(Select,{label:\"H\\u1ECDc k\\u1EF3\",name:\"semester_id\",value:newClass.semester_id,onChange:handleNewClassChange,children:semesters.map(sem=>/*#__PURE__*/_jsxs(MenuItem,{value:sem._id,children:[sem.name,\" (\",sem.academic_year,\")\"]},sem._id))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"L\\u1EDBp ch\\xEDnh\"}),/*#__PURE__*/_jsxs(Select,{label:\"L\\u1EDBp ch\\xEDnh\",name:\"main_class_id\",value:newClass.main_class_id,onChange:handleNewClassChange,children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"Kh\\xF4ng ch\\u1ECDn l\\u1EDBp ch\\xEDnh\"}),mainClasses.map(mainClass=>/*#__PURE__*/_jsxs(MenuItem,{value:mainClass._id,children:[mainClass.name,\" (\",mainClass.class_code,\")\"]},mainClass._id))]}),/*#__PURE__*/_jsx(FormHelperText,{children:\"C\\xF3 th\\u1EC3 \\u0111\\u1EC3 tr\\u1ED1ng n\\u1EBFu l\\u1EDBp d\\xE0nh cho nhi\\u1EC1u l\\u1EDBp ch\\xEDnh\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,type:\"number\",label:\"T\\u1ED5ng s\\u1ED1 bu\\u1ED5i h\\u1ECDc\",name:\"total_sessions\",value:newClass.total_sessions,onChange:handleTotalSessionsChange,required:true,variant:\"outlined\",InputProps:{inputProps:{min:1}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,type:\"date\",label:\"Ng\\xE0y b\\u1EAFt \\u0111\\u1EA7u kh\\xF3a h\\u1ECDc\",name:\"course_start_date\",value:newClass.course_start_date,onChange:handleStartDateChange,required:true,variant:\"outlined\",InputLabelProps:{shrink:true}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,type:\"date\",label:\"Ng\\xE0y k\\u1EBFt th\\xFAc kh\\xF3a h\\u1ECDc (t\\u1EF1 \\u0111\\u1ED9ng t\\xEDnh)\",name:\"course_end_date\",value:newClass.course_end_date,disabled:true,variant:\"outlined\",InputLabelProps:{shrink:true},helperText:\"\\u0110\\u01B0\\u1EE3c t\\xEDnh t\\u1EF1 \\u0111\\u1ED9ng t\\u1EEB ng\\xE0y b\\u1EAFt \\u0111\\u1EA7u v\\xE0 l\\u1ECBch h\\u1ECDc\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"T\\u1EF1 \\u0111\\u1ED9ng t\\u1EA1o bu\\u1ED5i h\\u1ECDc\"}),/*#__PURE__*/_jsxs(Select,{label:\"T\\u1EF1 \\u0111\\u1ED9ng t\\u1EA1o bu\\u1ED5i h\\u1ECDc\",name:\"auto_generate_sessions\",value:newClass.auto_generate_sessions,onChange:handleNewClassChange,children:[/*#__PURE__*/_jsx(MenuItem,{value:true,children:\"C\\xF3\"}),/*#__PURE__*/_jsx(MenuItem,{value:false,children:\"Kh\\xF4ng\"})]}),/*#__PURE__*/_jsx(FormHelperText,{children:\"Khi b\\u1EADt, h\\u1EC7 th\\u1ED1ng s\\u1EBD t\\u1EF1 \\u0111\\u1ED9ng t\\u1EA1o c\\xE1c bu\\u1ED5i h\\u1ECDc d\\u1EF1a tr\\xEAn l\\u1ECBch\"})]})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",gutterBottom:true,sx:{fontWeight:\"bold\",mt:2},children:[/*#__PURE__*/_jsx(RoomIcon,{sx:{verticalAlign:\"middle\",mr:1}}),\"Th\\xF4ng tin ph\\xF2ng h\\u1ECDc\"]}),/*#__PURE__*/_jsx(Divider,{sx:{mb:2}})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"C\\u01A1 s\\u1EDF\"}),/*#__PURE__*/_jsxs(Select,{label:\"C\\u01A1 s\\u1EDF\",value:selectedCampus,onChange:handleCampusChange,children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"Ch\\u1ECDn c\\u01A1 s\\u1EDF\"}),campuses.map(campus=>/*#__PURE__*/_jsx(MenuItem,{value:campus._id,children:campus.name},campus._id))]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,disabled:!selectedCampus,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"T\\xF2a nh\\xE0\"}),/*#__PURE__*/_jsxs(Select,{label:\"T\\xF2a nh\\xE0\",value:selectedBuilding,onChange:handleBuildingChange,children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"Ch\\u1ECDn t\\xF2a nh\\xE0\"}),buildings.map(building=>/*#__PURE__*/_jsx(MenuItem,{value:building._id,children:building.name},building._id))]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,disabled:!selectedBuilding,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Ph\\xF2ng h\\u1ECDc\"}),/*#__PURE__*/_jsxs(Select,{label:\"Ph\\xF2ng h\\u1ECDc\",name:\"room_id\",value:newClass.room_id,onChange:handleNewClassChange,children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"Ch\\u1ECDn ph\\xF2ng h\\u1ECDc\"}),rooms.map(room=>/*#__PURE__*/_jsxs(MenuItem,{value:room._id,children:[room.room_number,\" (S\\u1EE9c ch\\u1EE9a: \",room.capacity,\")\"]},room._id))]})]})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",gutterBottom:true,sx:{fontWeight:\"bold\",mt:2},children:[/*#__PURE__*/_jsx(Event,{sx:{verticalAlign:\"middle\",mr:1}}),\"L\\u1ECBch h\\u1ECDc\"]}),/*#__PURE__*/_jsx(Divider,{sx:{mb:2}})]}),scheduleDays.map((day,index)=>/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{ml:0,mt:1,width:\"100%\",pb:2,borderBottom:index<scheduleDays.length-1?\"1px dashed #ddd\":\"none\"},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:3,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Th\\u1EE9 trong tu\\u1EA7n\",value:getDayOfWeekName(day.day_of_week),InputProps:{readOnly:true},variant:\"outlined\",helperText:\"\\u0110\\u01B0\\u1EE3c x\\xE1c \\u0111\\u1ECBnh t\\u1EEB ng\\xE0y b\\u1EAFt \\u0111\\u1EA7u\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:2,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Ti\\u1EBFt b\\u1EAFt \\u0111\\u1EA7u\",type:\"number\",value:day.start_period,onChange:e=>handleScheduleChange(index,\"start_period\",parseInt(e.target.value)),InputProps:{inputProps:{min:1,max:15}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:2,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Ti\\u1EBFt k\\u1EBFt th\\xFAc\",type:\"number\",value:day.end_period,onChange:e=>handleScheduleChange(index,\"end_period\",parseInt(e.target.value)),InputProps:{inputProps:{min:day.start_period,max:15}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:2,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Gi\\u1EDD b\\u1EAFt \\u0111\\u1EA7u\",type:\"time\",value:day.start_time,onChange:e=>handleScheduleChange(index,\"start_time\",e.target.value),InputLabelProps:{shrink:true}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:2,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Gi\\u1EDD k\\u1EBFt th\\xFAc\",type:\"time\",value:day.end_time,onChange:e=>handleScheduleChange(index,\"end_time\",e.target.value),InputLabelProps:{shrink:true}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:1,sx:{display:\"flex\",alignItems:\"center\"},children:/*#__PURE__*/_jsx(IconButton,{color:\"error\",onClick:()=>removeScheduleDay(index),disabled:scheduleDays.length<=1,children:/*#__PURE__*/_jsx(Chip,{label:\"X\\xF3a\",color:\"error\",size:\"small\",variant:\"outlined\",disabled:scheduleDays.length<=1})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Ph\\xF2ng h\\u1ECDc ri\\xEAng\"}),/*#__PURE__*/_jsxs(Select,{label:\"Ph\\xF2ng h\\u1ECDc ri\\xEAng\",value:day.room_id||\"\",onChange:e=>handleScheduleChange(index,\"room_id\",e.target.value),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"D\\xF9ng ph\\xF2ng m\\u1EB7c \\u0111\\u1ECBnh\"}),rooms.map(room=>/*#__PURE__*/_jsxs(MenuItem,{value:room._id,children:[room.room_number,\" (S\\u1EE9c ch\\u1EE9a: \",room.capacity,\")\"]},room._id))]}),/*#__PURE__*/_jsx(FormHelperText,{children:\"Ph\\xF2ng h\\u1ECDc ri\\xEAng cho bu\\u1ED5i n\\xE0y, \\u0111\\u1EC3 tr\\u1ED1ng s\\u1EBD d\\xF9ng ph\\xF2ng m\\u1EB7c \\u0111\\u1ECBnh c\\u1EE7a l\\u1EDBp\"})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Lo\\u1EA1i l\\u1ECBch\"}),/*#__PURE__*/_jsxs(Select,{label:\"Lo\\u1EA1i l\\u1ECBch\",value:day.is_recurring,onChange:e=>handleScheduleChange(index,\"is_recurring\",e.target.value),children:[/*#__PURE__*/_jsx(MenuItem,{value:true,children:\"\\u0110\\u1ECBnh k\\u1EF3 h\\xE0ng tu\\u1EA7n\"}),/*#__PURE__*/_jsx(MenuItem,{value:false,children:\"C\\xE1c ng\\xE0y c\\u1EE5 th\\u1EC3\"})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:4,children:day.is_recurring?/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>{// Hàm để mở dialog chọn ngày nghỉ\n// Có thể triển khai sau\n},children:\"Th\\xEAm ng\\xE0y ngh\\u1EC9\"}):/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",onClick:()=>{// Hàm để mở dialog chọn ngày cụ thể\n// Có thể triển khai sau\n},children:\"Ch\\u1ECDn ng\\xE0y h\\u1ECDc c\\u1EE5 th\\u1EC3\"})})]},index)),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"primary\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:addScheduleDay,sx:{mt:1},children:\"Th\\xEAm l\\u1ECBch h\\u1ECDc\"})})]})}),/*#__PURE__*/_jsxs(DialogActions,{sx:{px:3,pb:2},children:[/*#__PURE__*/_jsx(Button,{onClick:handleCloseAddClassDialog,disabled:isSubmitting,children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCreateClass,variant:\"contained\",color:\"primary\",disabled:isSubmitting,startIcon:isSubmitting?/*#__PURE__*/_jsx(CircularProgress,{size:20}):/*#__PURE__*/_jsx(Add,{}),children:isSubmitting?\"Đang tạo...\":\"Tạo lớp học\"})]})]})]});};export default TeacherClassesPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}