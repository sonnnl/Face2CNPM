{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kasiz\\\\Documents\\\\Studying\\\\FaceReg\\\\frontend\\\\src\\\\components\\\\auth\\\\PrivateRoute.js\",\n  _s = $RefreshSig$();\nimport React from \"react\";\nimport { Navigate, Outlet, useLocation } from \"react-router-dom\";\nimport { useSelector } from \"react-redux\";\nimport { CircularProgress, Box } from \"@mui/material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PrivateRoute = ({\n  allowedRoles = []\n}) => {\n  _s();\n  const {\n    isAuthenticated,\n    user,\n    loading\n  } = useSelector(state => state.auth);\n  const location = useLocation();\n\n  // Hiển thị loading khi đang kiểm tra trạng thái đăng nhập\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        height: \"100vh\"\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Kiểm tra người dùng đã đăng nhập hay chưa\n  if (!isAuthenticated) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Kiểm tra trạng thái phê duyệt\n  if (user.status === \"pending\") {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/pending-approval\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Kiểm tra vai trò người dùng\n  if (allowedRoles.length > 0 && !allowedRoles.includes(user.role)) {\n    // Chuyển hướng đến trang mặc định dựa trên vai trò\n    const roleDefaultRoutes = {\n      admin: \"/admin\",\n      teacher: \"/teacher\",\n      student: \"/student\"\n    };\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: roleDefaultRoutes[user.role] || \"/login\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Người dùng đã đăng nhập và có quyền truy cập\n  return /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 10\n  }, this);\n};\n_s(PrivateRoute, \"S0L+0/TA9Uj4dqMttQnZVKZjsc0=\", false, function () {\n  return [useSelector, useLocation];\n});\n_c = PrivateRoute;\nexport default PrivateRoute;\nvar _c;\n$RefreshReg$(_c, \"PrivateRoute\");","map":{"version":3,"names":["React","Navigate","Outlet","useLocation","useSelector","CircularProgress","Box","jsxDEV","_jsxDEV","PrivateRoute","allowedRoles","_s","isAuthenticated","user","loading","state","auth","location","sx","display","justifyContent","alignItems","height","children","fileName","_jsxFileName","lineNumber","columnNumber","to","from","replace","status","length","includes","role","roleDefaultRoutes","admin","teacher","student","_c","$RefreshReg$"],"sources":["C:/Users/kasiz/Documents/Studying/FaceReg/frontend/src/components/auth/PrivateRoute.js"],"sourcesContent":["import React from \"react\";\r\nimport { Navigate, Outlet, useLocation } from \"react-router-dom\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { CircularProgress, Box } from \"@mui/material\";\r\n\r\nconst PrivateRoute = ({ allowedRoles = [] }) => {\r\n  const { isAuthenticated, user, loading } = useSelector((state) => state.auth);\r\n  const location = useLocation();\r\n\r\n  // Hiển thị loading khi đang kiểm tra trạng thái đăng nhập\r\n  if (loading) {\r\n    return (\r\n      <Box\r\n        sx={{\r\n          display: \"flex\",\r\n          justifyContent: \"center\",\r\n          alignItems: \"center\",\r\n          height: \"100vh\",\r\n        }}\r\n      >\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  // Kiểm tra người dùng đã đăng nhập hay chưa\r\n  if (!isAuthenticated) {\r\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\r\n  }\r\n\r\n  // Kiểm tra trạng thái phê duyệt\r\n  if (user.status === \"pending\") {\r\n    return <Navigate to=\"/pending-approval\" replace />;\r\n  }\r\n\r\n  // Kiểm tra vai trò người dùng\r\n  if (allowedRoles.length > 0 && !allowedRoles.includes(user.role)) {\r\n    // Chuyển hướng đến trang mặc định dựa trên vai trò\r\n    const roleDefaultRoutes = {\r\n      admin: \"/admin\",\r\n      teacher: \"/teacher\",\r\n      student: \"/student\",\r\n    };\r\n    return <Navigate to={roleDefaultRoutes[user.role] || \"/login\"} replace />;\r\n  }\r\n\r\n  // Người dùng đã đăng nhập và có quyền truy cập\r\n  return <Outlet />;\r\n};\r\n\r\nexport default PrivateRoute;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,EAAEC,MAAM,EAAEC,WAAW,QAAQ,kBAAkB;AAChE,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,gBAAgB,EAAEC,GAAG,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtD,MAAMC,YAAY,GAAGA,CAAC;EAAEC,YAAY,GAAG;AAAG,CAAC,KAAK;EAAAC,EAAA;EAC9C,MAAM;IAAEC,eAAe;IAAEC,IAAI;IAAEC;EAAQ,CAAC,GAAGV,WAAW,CAAEW,KAAK,IAAKA,KAAK,CAACC,IAAI,CAAC;EAC7E,MAAMC,QAAQ,GAAGd,WAAW,CAAC,CAAC;;EAE9B;EACA,IAAIW,OAAO,EAAE;IACX,oBACEN,OAAA,CAACF,GAAG;MACFY,EAAE,EAAE;QACFC,OAAO,EAAE,MAAM;QACfC,cAAc,EAAE,QAAQ;QACxBC,UAAU,EAAE,QAAQ;QACpBC,MAAM,EAAE;MACV,CAAE;MAAAC,QAAA,eAEFf,OAAA,CAACH,gBAAgB;QAAAmB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACjB,CAAC;EAEV;;EAEA;EACA,IAAI,CAACf,eAAe,EAAE;IACpB,oBAAOJ,OAAA,CAACP,QAAQ;MAAC2B,EAAE,EAAC,QAAQ;MAACb,KAAK,EAAE;QAAEc,IAAI,EAAEZ;MAAS,CAAE;MAACa,OAAO;IAAA;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACpE;;EAEA;EACA,IAAId,IAAI,CAACkB,MAAM,KAAK,SAAS,EAAE;IAC7B,oBAAOvB,OAAA,CAACP,QAAQ;MAAC2B,EAAE,EAAC,mBAAmB;MAACE,OAAO;IAAA;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACpD;;EAEA;EACA,IAAIjB,YAAY,CAACsB,MAAM,GAAG,CAAC,IAAI,CAACtB,YAAY,CAACuB,QAAQ,CAACpB,IAAI,CAACqB,IAAI,CAAC,EAAE;IAChE;IACA,MAAMC,iBAAiB,GAAG;MACxBC,KAAK,EAAE,QAAQ;MACfC,OAAO,EAAE,UAAU;MACnBC,OAAO,EAAE;IACX,CAAC;IACD,oBAAO9B,OAAA,CAACP,QAAQ;MAAC2B,EAAE,EAAEO,iBAAiB,CAACtB,IAAI,CAACqB,IAAI,CAAC,IAAI,QAAS;MAACJ,OAAO;IAAA;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAC3E;;EAEA;EACA,oBAAOnB,OAAA,CAACN,MAAM;IAAAsB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AACnB,CAAC;AAAChB,EAAA,CA3CIF,YAAY;EAAA,QAC2BL,WAAW,EACrCD,WAAW;AAAA;AAAAoC,EAAA,GAFxB9B,YAAY;AA6ClB,eAAeA,YAAY;AAAC,IAAA8B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}