{"ast":null,"code":"import React,{useState,useEffect,useCallback,useMemo}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useSnackbar}from\"notistack\";import{Box,Typography,Tabs,Tab,Paper,Button,TextField,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,TablePagination,IconButton,Dialog,DialogActions,DialogContent,DialogContentText,DialogTitle,Grid,Card,Chip,Tooltip,CircularProgress,FormControl,InputLabel,Select,MenuItem,InputAdornment,Container}from\"@mui/material\";import{Add,Delete,Edit,Search,Refresh,Room,Domain,ArrowBack,LocationOn}from\"@mui/icons-material\";import{fetchBuildings,createBuilding,updateBuilding,deleteBuilding,fetchRooms,createRoom,updateRoom,deleteRoom,fetchAllCampuses,createCampus,updateCampus,deleteCampus,setSelectedCampus,setSelectedBuilding}from\"../../redux/slices/facilitySlice\";import{toast}from\"react-hot-toast\";import axiosInstance from\"../../utils/axios\";// Các giá trị mặc định cho form\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const defaultCampusFormData={name:\"\",code:\"\",address:\"\",status:\"active\"};const defaultBuildingFormData={name:\"\",code:\"\",campus_id:\"\",floors_count:1,year_built:new Date().getFullYear(),status:\"active\",facilities:[],image_url:\"\"};const defaultRoomFormData={_id:\"\",room_number:\"\",building_id:\"\",floor:\"1\",capacity:\"0\",room_type:\"lecture\",status:\"available\",equipment:[]};// Danh sách tiện ích có sẵn\nconst availableEquipment=[{id:\"projector\",label:\"Máy chiếu\"},{id:\"air_conditioner\",label:\"Máy lạnh\"},{id:\"computer\",label:\"Máy tính\"},{id:\"tv\",label:\"TV\"},{id:\"sound_system\",label:\"Hệ thống âm thanh\"},{id:\"whiteboard\",label:\"Bảng trắng\"},{id:\"wifi\",label:\"WiFi\"}];// Room types và status hợp lệ\nconst roomTypes=[{value:\"lecture\",label:\"Phòng học\"},{value:\"lab\",label:\"Phòng thực hành\"},{value:\"office\",label:\"Phòng làm việc\"},{value:\"meeting\",label:\"Phòng họp\"}];const roomStatuses=[{value:\"available\",label:\"Hoạt động\"},{value:\"maintenance\",label:\"Bảo trì\"},{value:\"unavailable\",label:\"Không hoạt động\"}];// Danh sách tiện ích tòa nhà\nconst buildingFacilities=[{id:\"elevator\",label:\"Thang máy\"},{id:\"parking\",label:\"Bãi đỗ xe\"},{id:\"security\",label:\"Bảo vệ 24/7\"},{id:\"cafeteria\",label:\"Căn tin\"},{id:\"disabled_access\",label:\"Lối đi cho người khuyết tật\"},{id:\"wifi\",label:\"WiFi\"},{id:\"backup_power\",label:\"Nguồn điện dự phòng\"}];const FacilitiesPage=()=>{const dispatch=useDispatch();const{enqueueSnackbar}=useSnackbar();// Lấy trạng thái từ Redux\nconst{campuses,buildings,rooms,selectedCampus,selectedBuilding,isLoading,buildingPagination,roomPagination}=useSelector(state=>state.facility);// States cho tabs\nconst[tabValue,setTabValue]=useState(0);// State cho form submission\nconst[isSubmitting,setIsSubmitting]=useState(false);// Quản lý cơ sở (Campuses)\nconst[localCampusList,setLocalCampusList]=useState([]);const[campusSearchTerm,setCampusSearchTerm]=useState(\"\");const[campusPage,setCampusPage]=useState(0);const[campusRowsPerPage,setCampusRowsPerPage]=useState(10);// Quản lý tòa nhà (Buildings)\nconst[buildingSearchTerm,setBuildingSearchTerm]=useState(\"\");const[buildingPage,setBuildingPage]=useState(0);const[buildingRowsPerPage,setBuildingRowsPerPage]=useState(10);// Quản lý phòng học (Rooms)\nconst[roomSearchTerm,setRoomSearchTerm]=useState(\"\");const[roomPage,setRoomPage]=useState(0);const[roomRowsPerPage,setRoomRowsPerPage]=useState(10);// States cho dialogs cơ sở\nconst[campusDialogOpen,setCampusDialogOpen]=useState(false);const[campusDialogMode,setCampusDialogMode]=useState(\"add\");const[campusFormData,setCampusFormData]=useState(defaultCampusFormData);const[searchTimeout,setSearchTimeout]=useState(null);// States cho dialogs tòa nhà\nconst[buildingDialogOpen,setBuildingDialogOpen]=useState(false);const[buildingDialogMode,setBuildingDialogMode]=useState(\"add\");const[buildingFormData,setBuildingFormData]=useState(defaultBuildingFormData);// States cho dialogs phòng học\nconst[roomDialogOpen,setRoomDialogOpen]=useState(false);const[roomDialogMode,setRoomDialogMode]=useState(\"add\");const[roomFormData,setRoomFormData]=useState(defaultRoomFormData);// States cho dialogs xóa\nconst[deleteDialogOpen,setDeleteDialogOpen]=useState(false);const[deleteDialogType,setDeleteDialogType]=useState(\"building\");const[itemToDelete,setItemToDelete]=useState(null);// Selectors cho dữ liệu từ Redux store\nconst campusesData=useMemo(()=>{if(!campuses)return[];return Array.isArray(campuses)?campuses:campuses.data||[];},[campuses]);const totalCampusItems=useMemo(()=>{if(!campuses)return 0;return campuses.total||campuses.length||0;},[campuses]);// Fetch data khi component mount\nuseEffect(()=>{const fetchInitialData=async()=>{try{await dispatch(fetchAllCampuses({}));await fetchCampusList();}catch(error){console.error(\"Error fetching initial data:\",error);}};fetchInitialData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[dispatch]);// Fetch campuses từ API khi tìm kiếm\nuseEffect(()=>{if(campusSearchTerm!==undefined){const delaySearch=setTimeout(()=>{dispatch(fetchAllCampuses({limit:100,search:campusSearchTerm}));},500);return()=>clearTimeout(delaySearch);}},[dispatch,campusSearchTerm]);// Load dữ liệu campus\nconst loadCampuses=useCallback(()=>{dispatch(fetchAllCampuses({page:1,limit:100,search:campusSearchTerm}));},[dispatch,campusSearchTerm]);// Fetch buildings với phân trang và tìm kiếm\nconst loadBuildings=useCallback(()=>{const params={page:buildingPage+1,limit:buildingRowsPerPage};if(buildingSearchTerm){params.search=buildingSearchTerm;}if(selectedCampus!==null&&selectedCampus!==void 0&&selectedCampus._id){params.campus_id=selectedCampus._id;}dispatch(fetchBuildings(params));},[dispatch,buildingPage,buildingRowsPerPage,buildingSearchTerm,selectedCampus]);// Fetch rooms với phân trang và tìm kiếm\nconst loadRooms=useCallback(()=>{const params={page:roomPage+1,limit:roomRowsPerPage};if(roomSearchTerm){params.search=roomSearchTerm;}if(selectedBuilding!==null&&selectedBuilding!==void 0&&selectedBuilding._id){params.building_id=selectedBuilding._id;}dispatch(fetchRooms(params));},[dispatch,roomPage,roomRowsPerPage,roomSearchTerm,selectedBuilding]);// Chạy loadBuildings khi tham số thay đổi\nuseEffect(()=>{loadBuildings();},[loadBuildings]);// Chạy loadRooms khi tham số thay đổi\nuseEffect(()=>{if(selectedBuilding){loadRooms();}},[loadRooms,selectedBuilding]);// Fetch danh sách campuses cho dropdown\nconst fetchCampusList=useCallback(async()=>{try{const response=await axiosInstance.get(\"/facilities/campuses?limit=100\");setLocalCampusList(response.data.data);}catch(error){console.error(\"Lỗi khi tải danh sách cơ sở:\",error);toast.error(\"Không thể tải danh sách cơ sở cho dropdown\");}},[]);// Chạy fetchCampusList khi component mount\nuseEffect(()=>{fetchCampusList();},[fetchCampusList]);// Handlers cho tabs\nconst handleTabChange=(event,newValue)=>{setTabValue(newValue);// Tải dữ liệu theo tab\nif(newValue===0){loadCampuses();}else if(newValue===1){loadBuildings();}else if(newValue===2){loadRooms();}};// Xử lý tìm kiếm campus\nconst handleCampusSearchChange=e=>{setCampusSearchTerm(e.target.value);// Debounce search\nclearTimeout(searchTimeout);const timeout=setTimeout(()=>{dispatch(fetchAllCampuses({page:1,limit:100,search:e.target.value}));},500);setSearchTimeout(timeout);};// Xử lý thay đổi trang cho campus\nconst handleCampusChangePage=(event,newPage)=>{setCampusPage(newPage);};// Xử lý thay đổi số lượng hàng cho campus\nconst handleCampusChangeRowsPerPage=event=>{setCampusRowsPerPage(parseInt(event.target.value,10));setCampusPage(0);};// Handlers cho phân trang tòa nhà\nconst handleBuildingChangePage=(event,newPage)=>{setBuildingPage(newPage);};const handleBuildingChangeRowsPerPage=event=>{setBuildingRowsPerPage(parseInt(event.target.value,10));setBuildingPage(0);};// Handlers cho phân trang phòng học\nconst handleRoomChangePage=(event,newPage)=>{setRoomPage(newPage);};const handleRoomChangeRowsPerPage=event=>{setRoomRowsPerPage(parseInt(event.target.value,10));setRoomPage(0);};// Mở dialog campus (thêm hoặc sửa)\nconst handleCampusDialogOpen=function(mode){let campus=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;setCampusDialogMode(mode);if(mode===\"edit\"&&campus){setCampusFormData({...campus});}else{setCampusFormData(defaultCampusFormData);}setCampusDialogOpen(true);};// Đóng dialog campus\nconst handleCampusDialogClose=()=>{setCampusDialogOpen(false);setCampusFormData(defaultCampusFormData);};// Xử lý khi thay đổi form campus\nconst handleCampusFormChange=e=>{const{name,value}=e.target;setCampusFormData({...campusFormData,[name]:value});};// Xử lý submit form campus\nconst handleCampusFormSubmit=async()=>{try{var _campusFormData$addre;const trimmedData={...campusFormData,code:campusFormData.code.trim(),name:campusFormData.name.trim(),address:((_campusFormData$addre=campusFormData.address)===null||_campusFormData$addre===void 0?void 0:_campusFormData$addre.trim())||\"\",status:campusFormData.status||\"active\"};// Loại bỏ _id khi thêm mới\nif(campusDialogMode===\"add\"){delete trimmedData._id;await dispatch(createCampus(trimmedData)).unwrap();toast.success(\"Đã thêm cơ sở thành công\");}else{// Đảm bảo có id khi cập nhật\nconst updateData={id:trimmedData._id,data:{name:trimmedData.name,code:trimmedData.code,address:trimmedData.address,status:trimmedData.status}};await dispatch(updateCampus(updateData)).unwrap();toast.success(\"Đã cập nhật cơ sở thành công\");}setCampusDialogOpen(false);setCampusFormData(defaultCampusFormData);// Đảm bảo tải lại dữ liệu sau khi thêm/cập nhật\nsetTimeout(()=>{dispatch(fetchAllCampuses({}));fetchCampusList();},500);}catch(error){console.error(\"Lỗi khi xử lý form cơ sở:\",error);toast.error((error===null||error===void 0?void 0:error.message)||\"Đã có lỗi xảy ra khi xử lý cơ sở\");}};// Xử lý xóa campus\nconst handleDeleteCampus=campusId=>{if(window.confirm(\"Bạn có chắc chắn muốn xóa cơ sở này không?\")){dispatch(deleteCampus(campusId)).unwrap().then(()=>{toast.success(\"Đã xóa cơ sở thành công\");dispatch(fetchAllCampuses());// Refresh list\n}).catch(error=>{console.error(\"Lỗi khi xóa cơ sở:\",error);toast.error((error===null||error===void 0?void 0:error.message)||\"Đã có lỗi xảy ra khi xóa cơ sở\");});}};// Handlers cho bật/tắt building dialog\nconst handleBuildingDialogOpen=function(mode){let building=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;setBuildingDialogMode(mode);if(mode===\"edit\"&&building){setBuildingFormData({_id:building._id,name:building.name,code:building.code,campus_id:building.campus_id||\"\",floors_count:building.floors_count||1,year_built:building.year_built||new Date().getFullYear(),status:building.status||\"active\",facilities:building.facilities||[],image_url:building.image_url||\"\"});}else{setBuildingFormData({...defaultBuildingFormData,campus_id:(selectedCampus===null||selectedCampus===void 0?void 0:selectedCampus._id)||\"\"});}setBuildingDialogOpen(true);};const handleCloseBuildingDialog=()=>{setBuildingDialogOpen(false);};// Handler cho building form change\nconst handleBuildingFormChange=e=>{const{name,value}=e.target;setBuildingFormData(prev=>({...prev,[name]:value}));};// Handler cho submit building form\nconst handleBuildingFormSubmit=async e=>{e.preventDefault();// Validate form data\nif(!buildingFormData.name.trim()||!buildingFormData.code.trim()){toast.error(\"Vui lòng nhập đầy đủ tên và mã tòa nhà\");return;}// Kiểm tra campus_id\nif(!buildingFormData.campus_id){toast.error(\"Vui lòng chọn cơ sở cho tòa nhà\");return;}try{if(buildingDialogMode===\"add\"){// Tạo object mới chỉ với các trường cần thiết và loại bỏ _id\nconst newBuildingData={name:buildingFormData.name.trim(),code:buildingFormData.code.trim(),campus_id:buildingFormData.campus_id,floors_count:Number(buildingFormData.floors_count),year_built:Number(buildingFormData.year_built),status:buildingFormData.status,facilities:buildingFormData.facilities||[]};await dispatch(createBuilding(newBuildingData)).unwrap();toast.success(\"Thêm tòa nhà thành công\");}else{// Cập nhật với định dạng {id, buildingData}\nconst updateData={id:buildingFormData._id,buildingData:{name:buildingFormData.name.trim(),code:buildingFormData.code.trim(),campus_id:buildingFormData.campus_id,floors_count:Number(buildingFormData.floors_count),year_built:Number(buildingFormData.year_built),status:buildingFormData.status,facilities:buildingFormData.facilities||[]}};await dispatch(updateBuilding(updateData)).unwrap();toast.success(\"Cập nhật tòa nhà thành công\");}handleCloseBuildingDialog();// Đảm bảo tải lại dữ liệu sau khi thêm/cập nhật\nsetTimeout(()=>{loadBuildings();},500);}catch(error){console.error(\"Lỗi khi xử lý form tòa nhà:\",error);if(error.message===\"jwt expired\"){toast.error(\"Phiên đăng nhập hết hạn, vui lòng đăng nhập lại\");}else{toast.error(error.message||\"Có lỗi xảy ra khi xử lý thông tin tòa nhà\");}}};// Handlers cho bật/tắt room dialog\nconst handleRoomDialogOpen=function(mode){let room=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;setRoomDialogMode(mode);if(mode===\"edit\"&&room){setRoomFormData({_id:room._id||\"\",room_number:room.room_number||\"\",building_id:room.building_id||\"\",floor:room.floor?String(room.floor):\"1\",capacity:room.capacity?String(room.capacity):\"0\",room_type:room.room_type||\"lecture\",status:room.status||\"available\",equipment:room.equipment||[]});}else{setRoomFormData({_id:\"\",room_number:\"\",building_id:(selectedBuilding===null||selectedBuilding===void 0?void 0:selectedBuilding._id)||\"\",floor:\"1\",capacity:\"0\",room_type:\"lecture\",status:\"available\",equipment:[]});}setRoomDialogOpen(true);};const handleCloseRoomDialog=()=>{setRoomDialogOpen(false);};// Handler cho room form change\nconst handleRoomFormChange=e=>{const{name,value}=e.target;setRoomFormData(prev=>({...prev,[name]:value}));};// Handler cho submit room form\nconst handleRoomFormSubmit=async e=>{e.preventDefault();// Validate form data\nif(!roomFormData.room_number.trim()){toast.error(\"Vui lòng nhập đầy đủ số phòng\");return;}// Kiểm tra building_id\nif(!roomFormData.building_id){toast.error(\"Vui lòng chọn tòa nhà cho phòng học\");return;}try{if(roomDialogMode===\"add\"){// Tạo object mới chỉ với các trường cần thiết và loại bỏ _id\nconst newRoomData={room_number:roomFormData.room_number.trim(),building_id:roomFormData.building_id,floor:Number(roomFormData.floor),capacity:Number(roomFormData.capacity),room_type:roomFormData.room_type,status:roomFormData.status,equipment:roomFormData.equipment||[]};await dispatch(createRoom(newRoomData)).unwrap();toast.success(\"Thêm phòng học thành công\");}else{// Cập nhật với định dạng {id, data}\nconst updateData={id:roomFormData._id,data:{room_number:roomFormData.room_number.trim(),building_id:roomFormData.building_id,floor:Number(roomFormData.floor),capacity:Number(roomFormData.capacity),room_type:roomFormData.room_type,status:roomFormData.status,equipment:roomFormData.equipment||[]}};console.log(\"Dữ liệu cập nhật phòng:\",updateData);await dispatch(updateRoom(updateData)).unwrap();toast.success(\"Cập nhật phòng học thành công\");}handleCloseRoomDialog();// Đảm bảo tải lại dữ liệu sau khi thêm/cập nhật\nsetTimeout(()=>{loadRooms();},500);}catch(error){console.error(\"Lỗi khi xử lý form phòng học:\",error);if(error.message===\"jwt expired\"){toast.error(\"Phiên đăng nhập hết hạn, vui lòng đăng nhập lại\");}else{toast.error(error.message||\"Có lỗi xảy ra khi xử lý thông tin phòng học\");}}};// Handlers cho xóa\nconst openDeleteDialog=(type,item)=>{setDeleteDialogType(type);setItemToDelete(item);setDeleteDialogOpen(true);};const handleDeleteItem=async()=>{setIsSubmitting(true);try{if(deleteDialogType===\"campus\"&&itemToDelete){await dispatch(deleteCampus(itemToDelete._id)).unwrap();enqueueSnackbar(\"Xóa cơ sở thành công\",{variant:\"success\"});loadCampuses();}else if(deleteDialogType===\"building\"&&itemToDelete){await dispatch(deleteBuilding(itemToDelete._id)).unwrap();enqueueSnackbar(\"Xóa tòa nhà thành công\",{variant:\"success\"});loadBuildings();}else if(deleteDialogType===\"room\"&&itemToDelete){await dispatch(deleteRoom(itemToDelete._id)).unwrap();enqueueSnackbar(\"Xóa phòng học thành công\",{variant:\"success\"});loadRooms();}}catch(error){enqueueSnackbar(error.message||`Không thể xóa ${deleteDialogType}. Vui lòng thử lại.`,{variant:\"error\"});}finally{setIsSubmitting(false);setDeleteDialogOpen(false);}};// Handler cho việc chọn cơ sở\nconst handleSelectCampus=campus=>{dispatch(setSelectedCampus(campus));// Tải danh sách tòa nhà của cơ sở đã chọn\nconst params={page:1,limit:buildingRowsPerPage,search:buildingSearchTerm,campus_id:campus._id};dispatch(fetchBuildings(params));setTabValue(1);// Chuyển sang tab tòa nhà\n};// Handler cho việc chọn tòa nhà\nconst handleSelectBuilding=building=>{dispatch(setSelectedBuilding(building));// Tải danh sách phòng của tòa nhà đã chọn\nconst params={page:1,limit:roomRowsPerPage,search:roomSearchTerm,building_id:building._id};dispatch(fetchRooms(params));setTabValue(2);// Chuyển sang tab phòng học\n};const handleBackToCampuses=()=>{dispatch(setSelectedCampus(null));setBuildingSearchTerm(\"\");setBuildingPage(0);};// Thêm handler quay lại tòa nhà từ phòng học\nconst handleBackToBuildings=()=>{dispatch(setSelectedBuilding(null));setRoomSearchTerm(\"\");setRoomPage(0);};// Thêm hàm xử lý building\nconst handleBuildingSearch=()=>{loadBuildings();};// Thêm hàm xử lý room\nconst handleRoomSearch=()=>{loadRooms();};const handleEditCampus=campus=>{setCampusFormData({_id:campus._id,code:campus.code,name:campus.name,address:campus.address||\"\",status:campus.status});setCampusDialogMode(\"edit\");setCampusDialogOpen(true);};// Hàm để chuyển đổi room_type thành văn bản hiển thị\nconst getRoomTypeLabel=type=>{const roomType=roomTypes.find(rt=>rt.value===type);return roomType?roomType.label:type;};// Hàm để chuyển đổi status thành văn bản hiển thị\nconst getRoomStatusLabel=status=>{const roomStatus=roomStatuses.find(rs=>rs.value===status);return roomStatus?roomStatus.label:status;};// Hàm để lấy màu sắc dựa trên status\nconst getRoomStatusColor=status=>{switch(status){case\"available\":return\"success\";case\"maintenance\":return\"warning\";case\"unavailable\":return\"error\";default:return\"default\";}};// Render tùy theo tab đang chọn\nconst renderTabContent=()=>{switch(tabValue){case 0:return renderCampusesTab();case 1:return renderBuildingsTab();case 2:return renderRoomsTab();default:return renderCampusesTab();}};// Render tab cơ sở\nconst renderCampusesTab=()=>{// Đảm bảo hiển thị dữ liệu mới nhất\nconst displayedCampuses=campusesData||[];console.log(\"Campuses data:\",displayedCampuses);// Debug\nreturn/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:2,display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(TextField,{label:\"T\\xECm ki\\u1EBFm c\\u01A1 s\\u1EDF\",variant:\"outlined\",size:\"small\",value:campusSearchTerm,onChange:handleCampusSearchChange,sx:{width:\"300px\"},InputProps:{endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(Search,{})})}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(Refresh,{}),onClick:()=>dispatch(fetchAllCampuses({})),sx:{mr:1},children:\"L\\xE0m m\\u1EDBi\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:()=>handleCampusDialogOpen(\"add\"),children:\"Th\\xEAm c\\u01A1 s\\u1EDF\"})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"STT\"}),/*#__PURE__*/_jsx(TableCell,{children:\"M\\xE3\"}),/*#__PURE__*/_jsx(TableCell,{children:\"T\\xEAn c\\u01A1 s\\u1EDF\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\u0110\\u1ECBa ch\\u1EC9\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:isLoading?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:7,align:\"center\",children:/*#__PURE__*/_jsx(CircularProgress,{size:24})})}):displayedCampuses.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:7,align:\"center\",children:\"Kh\\xF4ng c\\xF3 d\\u1EEF li\\u1EC7u\"})}):displayedCampuses.map((campus,index)=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:index+1}),/*#__PURE__*/_jsx(TableCell,{children:campus.code}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",alignItems:\"center\",cursor:\"pointer\",\"&:hover\":{color:\"primary.main\"}},onClick:()=>handleSelectCampus(campus),children:[/*#__PURE__*/_jsx(LocationOn,{sx:{mr:1,fontSize:20}}),campus.name]})}),/*#__PURE__*/_jsx(TableCell,{children:campus.address||\"N/A\"}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:campus.status===\"active\"?\"Hoạt động\":campus.status===\"maintenance\"?\"Bảo trì\":\"Không hoạt động\",color:campus.status===\"active\"?\"success\":campus.status===\"maintenance\"?\"warning\":\"error\",size:\"small\"})}),/*#__PURE__*/_jsxs(TableCell,{align:\"right\",children:[/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>handleEditCampus(campus),title:\"Ch\\u1EC9nh s\\u1EEDa\",children:/*#__PURE__*/_jsx(Edit,{})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>handleDeleteCampus(campus._id),title:\"X\\xF3a\",sx:{color:\"error.main\"},children:/*#__PURE__*/_jsx(Delete,{})})]})]},campus._id||index))})]})}),/*#__PURE__*/_jsx(TablePagination,{component:\"div\",count:totalCampusItems,page:campusPage,onPageChange:handleCampusChangePage,rowsPerPage:campusRowsPerPage,onRowsPerPageChange:handleCampusChangeRowsPerPage,rowsPerPageOptions:[5,10,25],labelRowsPerPage:\"S\\u1ED1 h\\xE0ng m\\u1ED7i trang:\",labelDisplayedRows:_ref=>{let{from,to,count}=_ref;return`${from}-${to} của ${count}`;}})]})]});};// Render tab tòa nhà\nconst renderBuildingsTab=()=>/*#__PURE__*/_jsxs(Box,{children:[selectedCampus&&/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(ArrowBack,{}),onClick:handleBackToCampuses,sx:{mb:2},children:\"Quay l\\u1EA1i danh s\\xE1ch c\\u01A1 s\\u1EDF\"}),/*#__PURE__*/_jsxs(Paper,{sx:{p:2},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[selectedCampus.name,\" (\",selectedCampus.code,\")\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"\\u0110\\u1ECBa ch\\u1EC9: \",selectedCampus.address]}),selectedCampus.description&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"M\\xF4 t\\u1EA3: \",selectedCampus.description]})]})]}),/*#__PURE__*/_jsx(Paper,{sx:{p:2,mb:3},children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:{xs:\"column\",sm:\"row\"},alignItems:{sm:\"center\"},justifyContent:\"space-between\",gap:2,children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,flexGrow:1,children:[/*#__PURE__*/_jsx(TextField,{label:\"T\\xECm ki\\u1EBFm t\\xF2a nh\\xE0\",variant:\"outlined\",size:\"small\",fullWidth:true,value:buildingSearchTerm,onChange:e=>{setBuildingSearchTerm(e.target.value);if(e.target.value.trim()===\"\"){handleBuildingSearch();}},InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(Search,{})})}}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleBuildingSearch,startIcon:/*#__PURE__*/_jsx(Search,{}),children:\"T\\xECm\"})]}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:2,children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(Refresh,{}),onClick:loadBuildings,children:\"L\\xE0m m\\u1EDBi\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:()=>handleBuildingDialogOpen(\"add\"),sx:{ml:2},children:\"Th\\xEAm t\\xF2a nh\\xE0\"})]})]})}),/*#__PURE__*/_jsxs(TableContainer,{component:Paper,children:[/*#__PURE__*/_jsxs(Table,{sx:{minWidth:650},children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"T\\xEAn t\\xF2a nh\\xE0\"}),/*#__PURE__*/_jsx(TableCell,{children:\"M\\xE3\"}),/*#__PURE__*/_jsx(TableCell,{children:\"C\\u01A1 s\\u1EDF\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"S\\u1ED1 t\\u1EA7ng\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Ti\\u1EC7n \\xEDch\"}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:\"H\\xE0nh \\u0111\\u1ED9ng\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:isLoading&&buildings.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:6,align:\"center\",children:/*#__PURE__*/_jsx(CircularProgress,{size:30})})}):buildings.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:6,align:\"center\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y t\\xF2a nh\\xE0 n\\xE0o\"})}):buildings.map(building=>{var _building$campus_id;return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Domain,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:building.name})]})}),/*#__PURE__*/_jsx(TableCell,{children:building.code}),/*#__PURE__*/_jsx(TableCell,{children:((_building$campus_id=building.campus_id)===null||_building$campus_id===void 0?void 0:_building$campus_id.name)||\"Không có thông tin\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:building.floors_count}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",flexWrap:\"wrap\",gap:0.5},children:building.facilities&&building.facilities.length>0?building.facilities.map(facilityId=>{const facility=buildingFacilities.find(f=>f.id===facilityId);return facility?/*#__PURE__*/_jsx(Chip,{label:facility.label,size:\"small\",variant:\"outlined\"},facilityId):null;}):/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Kh\\xF4ng c\\xF3\"})})}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"flex-end\",children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Xem ph\\xF2ng h\\u1ECDc\",children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",onClick:()=>handleSelectBuilding(building),children:/*#__PURE__*/_jsx(Room,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"S\\u1EEDa t\\xF2a nh\\xE0\",children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",onClick:()=>{dispatch(setSelectedBuilding(building));handleBuildingDialogOpen(\"edit\",building);},children:/*#__PURE__*/_jsx(Edit,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"X\\xF3a t\\xF2a nh\\xE0\",children:/*#__PURE__*/_jsx(IconButton,{color:\"error\",onClick:()=>openDeleteDialog(\"building\",building),children:/*#__PURE__*/_jsx(Delete,{})})})]})})]},building._id);})})]}),/*#__PURE__*/_jsx(TablePagination,{rowsPerPageOptions:[5,10,25],component:\"div\",count:buildingPagination.totalCount,rowsPerPage:buildingRowsPerPage,page:buildingPage,onPageChange:handleBuildingChangePage,onRowsPerPageChange:handleBuildingChangeRowsPerPage,labelRowsPerPage:\"D\\xF2ng m\\u1ED7i trang:\",labelDisplayedRows:_ref2=>{let{from,to,count}=_ref2;return`${from}-${to} trên ${count}`;}})]})]});// Render tab phòng học\nconst renderRoomsTab=()=>{var _selectedBuilding$cam;return/*#__PURE__*/_jsx(Box,{children:selectedBuilding?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(ArrowBack,{}),onClick:handleBackToBuildings,sx:{mb:2},children:\"Quay l\\u1EA1i danh s\\xE1ch t\\xF2a nh\\xE0\"}),/*#__PURE__*/_jsxs(Paper,{sx:{p:2},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[selectedBuilding.name,\" (\",selectedBuilding.code,\")\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"C\\u01A1 s\\u1EDF:\",\" \",((_selectedBuilding$cam=selectedBuilding.campus_id)===null||_selectedBuilding$cam===void 0?void 0:_selectedBuilding$cam.name)||\"Không có thông tin\"]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"S\\u1ED1 t\\u1EA7ng: \",selectedBuilding.floors_count]}),selectedBuilding.description&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"textSecondary\",children:[\"M\\xF4 t\\u1EA3: \",selectedBuilding.description]})]})]}),/*#__PURE__*/_jsx(Paper,{sx:{p:2,mb:3},children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:{xs:\"column\",sm:\"row\"},alignItems:{sm:\"center\"},justifyContent:\"space-between\",gap:2,children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,flexGrow:1,children:[/*#__PURE__*/_jsx(TextField,{label:\"T\\xECm ki\\u1EBFm ph\\xF2ng h\\u1ECDc\",variant:\"outlined\",size:\"small\",fullWidth:true,value:roomSearchTerm,onChange:e=>{setRoomSearchTerm(e.target.value);if(e.target.value.trim()===\"\"){handleRoomSearch();}},InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(Search,{})})}}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleRoomSearch,startIcon:/*#__PURE__*/_jsx(Search,{}),children:\"T\\xECm\"})]}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:2,children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(Refresh,{}),onClick:loadRooms,children:\"L\\xE0m m\\u1EDBi\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:()=>handleRoomDialogOpen(\"add\"),sx:{ml:2},children:\"Th\\xEAm ph\\xF2ng\"})]})]})}),/*#__PURE__*/_jsxs(TableContainer,{component:Paper,children:[/*#__PURE__*/_jsxs(Table,{sx:{minWidth:650},children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Ph\\xF2ng h\\u1ECDc\"}),/*#__PURE__*/_jsx(TableCell,{children:\"M\\xE3 ph\\xF2ng\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"T\\u1EA7ng\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"S\\u1EE9c ch\\u1EE9a\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Lo\\u1EA1i ph\\xF2ng\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Ti\\u1EC7n \\xEDch\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:\"H\\xE0nh \\u0111\\u1ED9ng\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:isLoading&&rooms.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:8,align:\"center\",children:/*#__PURE__*/_jsx(CircularProgress,{size:30})})}):rooms.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:8,align:\"center\",children:\"Kh\\xF4ng t\\xECm th\\u1EA5y ph\\xF2ng h\\u1ECDc n\\xE0o\"})}):rooms.map(room=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Room,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",children:[\"Ph\\xF2ng \",room.room_number]})]})}),/*#__PURE__*/_jsx(TableCell,{children:room.room_number}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:room.floor}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:room.capacity}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:getRoomTypeLabel(room.room_type),color:room.room_type===\"lecture\"?\"primary\":room.room_type===\"lab\"?\"secondary\":\"default\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",flexWrap:\"wrap\",gap:0.5},children:room.equipment&&room.equipment.length>0?room.equipment.map((equipmentItem,index)=>{// Xử lý cả trường hợp equipment là object hoặc chuỗi\nconst equipmentId=typeof equipmentItem===\"object\"?equipmentItem.name:equipmentItem;const equipment=availableEquipment.find(f=>f.id===equipmentId);return equipment?/*#__PURE__*/_jsx(Chip,{label:equipment.label,size:\"small\",variant:\"outlined\"},`${equipmentId}-${index}`):null;}):/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Kh\\xF4ng c\\xF3\"})})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:getRoomStatusLabel(room.status),color:getRoomStatusColor(room.status),size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"flex-end\",children:[/*#__PURE__*/_jsx(Tooltip,{title:\"S\\u1EEDa ph\\xF2ng h\\u1ECDc\",children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",onClick:()=>handleRoomDialogOpen(\"edit\",room),children:/*#__PURE__*/_jsx(Edit,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"X\\xF3a ph\\xF2ng h\\u1ECDc\",children:/*#__PURE__*/_jsx(IconButton,{color:\"error\",onClick:()=>openDeleteDialog(\"room\",room),children:/*#__PURE__*/_jsx(Delete,{})})})]})})]},room._id))})]}),/*#__PURE__*/_jsx(TablePagination,{rowsPerPageOptions:[5,10,25],component:\"div\",count:roomPagination.totalCount,rowsPerPage:roomRowsPerPage,page:roomPage,onPageChange:handleRoomChangePage,onRowsPerPageChange:handleRoomChangeRowsPerPage,labelRowsPerPage:\"D\\xF2ng m\\u1ED7i trang:\",labelDisplayedRows:_ref3=>{let{from,to,count}=_ref3;return`${from}-${to} trên ${count}`;}})]})]}):/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",minHeight:\"200px\",children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"textSecondary\",children:\"Vui l\\xF2ng ch\\u1ECDn m\\u1ED9t t\\xF2a nh\\xE0 \\u0111\\u1EC3 xem danh s\\xE1ch ph\\xF2ng h\\u1ECDc\"})})});};// Render dialog xác nhận xóa\nconst renderDeleteConfirmDialog=()=>{return/*#__PURE__*/_jsxs(Dialog,{open:deleteDialogOpen,onClose:()=>setDeleteDialogOpen(false),children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[\"X\\xE1c nh\\u1EADn x\\xF3a\",\" \",deleteDialogType===\"campus\"?\"cơ sở\":deleteDialogType===\"building\"?\"tòa nhà\":\"phòng\"]}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(DialogContentText,{children:[\"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n x\\xF3a\",\" \",deleteDialogType===\"campus\"?\"cơ sở\":deleteDialogType===\"building\"?\"tòa nhà\":\"phòng\",\" \",\"n\\xE0y? H\\xE0nh \\u0111\\u1ED9ng n\\xE0y kh\\xF4ng th\\u1EC3 ho\\xE0n t\\xE1c.\",deleteDialogType===\"campus\"&&\" Tất cả tòa nhà và phòng học trong cơ sở này cũng sẽ bị xóa.\",deleteDialogType===\"building\"&&\" Tất cả phòng học trong tòa nhà này cũng sẽ bị xóa.\"]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setDeleteDialogOpen(false),color:\"inherit\",children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{onClick:handleDeleteItem,color:\"error\",variant:\"contained\",disabled:isSubmitting,children:isSubmitting?/*#__PURE__*/_jsx(CircularProgress,{size:24}):\"Xóa\"})]})]});};// Dialog Campus\nconst renderCampusDialog=()=>{return/*#__PURE__*/_jsxs(Dialog,{open:campusDialogOpen,onClose:handleCampusDialogClose,maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:campusDialogMode===\"add\"?\"Thêm cơ sở mới\":\"Cập nhật cơ sở\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(Box,{component:\"form\",sx:{mt:2},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{name:\"code\",label:\"M\\xE3 c\\u01A1 s\\u1EDF\",fullWidth:true,required:true,value:campusFormData.code,onChange:handleCampusFormChange,variant:\"outlined\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{name:\"name\",label:\"T\\xEAn c\\u01A1 s\\u1EDF\",fullWidth:true,required:true,value:campusFormData.name,onChange:handleCampusFormChange,variant:\"outlined\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{name:\"address\",label:\"\\u0110\\u1ECBa ch\\u1EC9\",fullWidth:true,value:campusFormData.address,onChange:handleCampusFormChange,variant:\"outlined\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsxs(Select,{name:\"status\",value:campusFormData.status,onChange:handleCampusFormChange,label:\"Tr\\u1EA1ng th\\xE1i\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"active\",children:\"Ho\\u1EA1t \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"maintenance\",children:\"B\\u1EA3o tr\\xEC\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"inactive\",children:\"Kh\\xF4ng ho\\u1EA1t \\u0111\\u1ED9ng\"})]})]})})]})})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleCampusDialogClose,children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCampusFormSubmit,variant:\"contained\",color:\"primary\",disabled:!campusFormData.code||!campusFormData.name,children:campusDialogMode===\"add\"?\"Thêm mới\":\"Cập nhật\"})]})]});};// Dialog Building\nconst renderBuildingDialog=()=>{return/*#__PURE__*/_jsxs(Dialog,{open:buildingDialogOpen,onClose:handleCloseBuildingDialog,maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:buildingDialogMode===\"add\"?\"Thêm tòa nhà mới\":\"Sửa tòa nhà\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{mt:1},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{name:\"name\",label:\"T\\xEAn t\\xF2a nh\\xE0\",fullWidth:true,required:true,value:buildingFormData.name,onChange:handleBuildingFormChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{name:\"code\",label:\"M\\xE3 t\\xF2a nh\\xE0\",fullWidth:true,required:true,value:buildingFormData.code,onChange:handleBuildingFormChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Ch\\u1ECDn c\\u01A1 s\\u1EDF\"}),/*#__PURE__*/_jsx(Select,{name:\"campus_id\",value:buildingFormData.campus_id,onChange:handleBuildingFormChange,label:\"Ch\\u1ECDn c\\u01A1 s\\u1EDF\",children:localCampusList.map(campus=>/*#__PURE__*/_jsxs(MenuItem,{value:campus._id,children:[campus.name,\" (\",campus.code,\")\"]},campus._id))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{name:\"floors_count\",label:\"S\\u1ED1 t\\u1EA7ng\",type:\"number\",fullWidth:true,required:true,value:buildingFormData.floors_count,onChange:handleBuildingFormChange,InputProps:{inputProps:{min:1}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{name:\"year_built\",label:\"N\\u0103m x\\xE2y d\\u1EF1ng\",type:\"number\",fullWidth:true,required:true,value:buildingFormData.year_built,onChange:handleBuildingFormChange,InputProps:{inputProps:{min:1900,max:new Date().getFullYear()}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsxs(Select,{name:\"status\",value:buildingFormData.status,onChange:handleBuildingFormChange,label:\"Tr\\u1EA1ng th\\xE1i\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"active\",children:\"Ho\\u1EA1t \\u0111\\u1ED9ng\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"maintenance\",children:\"B\\u1EA3o tr\\xEC\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"inactive\",children:\"Ng\\u01B0ng ho\\u1EA1t \\u0111\\u1ED9ng\"})]})]})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:\"Ti\\u1EC7n \\xEDch\"}),/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",flexWrap:\"wrap\",gap:1},children:buildingFacilities.map(facility=>/*#__PURE__*/_jsx(Chip,{label:facility.label,color:buildingFormData.facilities.includes(facility.id)?\"primary\":\"default\",onClick:()=>{const newFacilities=buildingFormData.facilities.includes(facility.id)?buildingFormData.facilities.filter(id=>id!==facility.id):[...buildingFormData.facilities,facility.id];setBuildingFormData({...buildingFormData,facilities:newFacilities});},sx:{m:0.5,cursor:\"pointer\"}},facility.id))})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{name:\"image_url\",label:\"URL h\\xECnh \\u1EA3nh\",fullWidth:true,value:buildingFormData.image_url||\"\",onChange:handleBuildingFormChange})})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setBuildingDialogOpen(false),children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{onClick:handleBuildingFormSubmit,variant:\"contained\",color:\"primary\",disabled:!buildingFormData.name||!buildingFormData.code,children:buildingDialogMode===\"add\"?\"Tạo mới\":\"Cập nhật\"})]})]});};// Dialog Room\nconst renderRoomDialog=()=>{return/*#__PURE__*/_jsxs(Dialog,{open:roomDialogOpen,onClose:handleCloseRoomDialog,maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:roomDialogMode===\"add\"?\"Thêm phòng học mới\":\"Sửa phòng học\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{mt:1},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{name:\"room_number\",label:\"S\\u1ED1 ph\\xF2ng\",fullWidth:true,required:true,value:roomFormData.room_number,onChange:handleRoomFormChange})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{name:\"floor\",label:\"T\\u1EA7ng\",type:\"number\",fullWidth:true,required:true,value:roomFormData.floor,onChange:handleRoomFormChange,InputProps:{inputProps:{min:1,max:(selectedBuilding===null||selectedBuilding===void 0?void 0:selectedBuilding.floors_count)||100}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{name:\"capacity\",label:\"S\\u1EE9c ch\\u1EE9a\",type:\"number\",fullWidth:true,required:true,value:roomFormData.capacity,onChange:handleRoomFormChange,InputProps:{inputProps:{min:0}}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Lo\\u1EA1i ph\\xF2ng\"}),/*#__PURE__*/_jsx(Select,{name:\"room_type\",value:roomFormData.room_type,onChange:handleRoomFormChange,label:\"Lo\\u1EA1i ph\\xF2ng\",children:roomTypes.map(type=>/*#__PURE__*/_jsx(MenuItem,{value:type.value,children:type.label},type.value))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Tr\\u1EA1ng th\\xE1i\"}),/*#__PURE__*/_jsx(Select,{name:\"status\",value:roomFormData.status,onChange:handleRoomFormChange,label:\"Tr\\u1EA1ng th\\xE1i\",children:roomStatuses.map(status=>/*#__PURE__*/_jsx(MenuItem,{value:status.value,children:status.label},status.value))})]})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:\"Ti\\u1EC7n \\xEDch\"}),/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",flexWrap:\"wrap\",gap:1},children:availableEquipment.map(facility=>/*#__PURE__*/_jsx(Chip,{label:facility.label,color:roomFormData.equipment.includes(facility.id)?\"primary\":\"default\",onClick:()=>{const newEquipment=roomFormData.equipment.includes(facility.id)?roomFormData.equipment.filter(id=>id!==facility.id):[...roomFormData.equipment,facility.id];setRoomFormData({...roomFormData,equipment:newEquipment});},sx:{m:0.5,cursor:\"pointer\"}},facility.id))})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setRoomDialogOpen(false),children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{onClick:handleRoomFormSubmit,variant:\"contained\",color:\"primary\",disabled:!roomFormData.room_number,children:roomDialogMode===\"add\"?\"Tạo mới\":\"Cập nhật\"})]})]});};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"xl\",children:[/*#__PURE__*/_jsx(Box,{sx:{mb:4},children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:\"Qu\\u1EA3n l\\xFD c\\u01A1 s\\u1EDF v\\u1EADt ch\\u1EA5t\"})}),/*#__PURE__*/_jsxs(Tabs,{value:tabValue,onChange:handleTabChange,sx:{mb:3},children:[/*#__PURE__*/_jsx(Tab,{label:\"C\\u01A1 s\\u1EDF\"}),/*#__PURE__*/_jsx(Tab,{label:\"T\\xF2a nh\\xE0\"}),/*#__PURE__*/_jsx(Tab,{label:\"Ph\\xF2ng\"})]}),renderTabContent(),renderCampusDialog(),renderBuildingDialog(),renderRoomDialog(),renderDeleteConfirmDialog()]});};export default FacilitiesPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}