{"ast":null,"code":"import axios from\"axios\";import jwtDecode from\"jwt-decode\";import{toast}from\"react-hot-toast\";const API_URL=process.env.REACT_APP_API_URL||\"http://localhost:5000/api\";// Kiểm tra token đã hết hạn hay chưa\nconst isTokenExpired=token=>{if(!token)return true;try{const decoded=jwtDecode(token);return decoded.exp<Date.now()/1000;}catch(error){console.error(\"Token decode error:\",error);return true;}};// Tạo axios instance với cấu hình chung\nconst axiosInstance=axios.create({baseURL:API_URL,timeout:10000,headers:{\"Content-Type\":\"application/json\"}});// Thêm interceptor cho request\naxiosInstance.interceptors.request.use(config=>{// Lấy token từ localStorage\nconst token=localStorage.getItem(\"token\")||localStorage.getItem(\"userToken\");// Thêm token vào header nếu có\nif(token){config.headers.Authorization=`Bearer ${token}`;}return config;},error=>{// Xử lý lỗi request\nreturn Promise.reject(error);});// Thêm interceptor cho response\naxiosInstance.interceptors.response.use(response=>{// Trả về dữ liệu response\nreturn response;},error=>{// Xử lý các loại lỗi response\nif(error.response){// Server trả về response với status code nằm ngoài phạm vi 2xx\nconst{status,data}=error.response;switch(status){case 401:// Token hết hạn hoặc không hợp lệ\ntoast.error(\"Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại\");localStorage.removeItem(\"token\");localStorage.removeItem(\"userToken\");// Chuyển hướng đến trang đăng nhập nếu cần\n// window.location.href = '/login';\nbreak;case 403:toast.error(\"Bạn không có quyền thực hiện thao tác này\");break;case 404:toast.error(\"Không tìm thấy tài nguyên yêu cầu\");break;case 500:toast.error(\"Lỗi máy chủ, vui lòng thử lại sau\");break;default:toast.error((data===null||data===void 0?void 0:data.message)||\"Đã xảy ra lỗi\");break;}}else if(error.request){// Request đã được gửi nhưng không nhận được response\ntoast.error(\"Không thể kết nối đến máy chủ, vui lòng kiểm tra kết nối mạng\");}else{// Có lỗi khi thiết lập request\ntoast.error(\"Đã xảy ra lỗi khi gửi yêu cầu\");}return Promise.reject(error);});export default axiosInstance;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}